<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>第二、 角色和蓝图 - CARLA 模拟器 中文文档</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../extra.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "\u7b2c\u4e8c\u3001 \u89d2\u8272\u548c\u84dd\u56fe";
        var mkdocs_page_input_path = "core_actors.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> CARLA 模拟器 中文文档
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">主页</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">入门</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../start_introduction/">介绍</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../start_quickstart/">快速启动包安装</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">构建CARLA</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../build_linux/">Linux build</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../build_windows/">Windows build</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../build_update/">Update CARLA</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../build_system/">Build system</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../build_docker/">CARLA in Docker</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../build_faq/">F.A.Q.</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">第一步</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../core_concepts/">核心概念</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../core_world/">第一、 世界和客户端</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="./">第二、 角色和蓝图</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#_2">蓝图</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#_3">管理蓝图库</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#_4">参与者生命周期</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#_5">生成</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#_6">处理</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#_7">摧毁</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#_8">参与者类型</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#_9">传感器</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#_10">观察者</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#_11">交通标志和交通灯</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#_12">车辆</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#walkers">Walkers</a>
    </li>
        </ul>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../core_map/">第三、地图和导航 </a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../core_sensors/">第四、 传感器和数据</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">高级概念</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_opendrive/">OpenDRIVE 独立模式</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_ptv/">PTV-Vissim 联合仿真</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_recorder/">Recorder</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_rendering_options/">渲染选项</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_rss/">RSS</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_synchrony_timestep/">同步和时间步长</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_benchmarking/">基准性能</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_agents/">CARLA 代理</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">交通模拟</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../ts_traffic_simulation_overview/">交通模拟概述</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_traffic_manager/">Traffic Manager</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_sumo/">SUMO 联合仿真</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_scenic/">Scenic</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">参考</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../python_api/">Python API 参考</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../bp_library/">Blueprint Library</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ref_cpp/">C++ 参考</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ref_recorder_binary_file_format/">Recorder 二进制文件格式</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ref_sensors/">Sensors reference</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">插件</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../plugins_carlaviz/">carlaviz — web 可视化器</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">ROS 桥接器</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../ros_documentation/">ROS 桥文档</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">自定义地图</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_custom_map_overview/">CARLA 中自定义地图的概述</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_generate_map/">在 RoadRunner 中创建地图</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_add_map_package/">在CARLA包导入地图</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_add_map_source/">在 CARLA 源构建中导入地图</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_add_map_alternative/">导入地图的替代方法</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_manual_map_package/">手动准备地图包</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_custom_layers/">自定义地图：分层地图: Layered maps</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_custom_add_tl/">自定义地图：红绿灯和标志</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_custom_road_painter/">自定义地图：Road painter</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_custom_buildings/">自定义地图：程序建筑</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_custom_weather_landscape/">自定义地图：天气和景观</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_generate_pedestrian_navigation/">生成行人导航</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">大型地图</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../large_map_overview/">大型地图概述</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../large_map_roadrunner/">在RoadRunner中创建大地图</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../large_map_import/">导入/打包大地图</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">教程（通用）</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_add_friction_triggers/">添加摩擦触发器</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_control_vehicle_physics/">控制车辆物理模型</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_control_walker_skeletons/">控制行人骨骼</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_openstreetmap/">使用OpenStreetMap生成地图</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_retrieve_data/">检索模拟数据</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_carsim_integration/">CarSim 集成</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_rllib_integration/">RLlib 集成</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_chrono/">Chrono 集成</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../build_docker_unreal/">在 Docker 中构建虚幻引擎UE和 CARLA</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">教程（资产）</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_A_add_vehicle/">添加新车辆</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_A_add_props/">添加新道具</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_A_create_standalone/">创建独立包</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_A_material_customization/">材料定制</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">教程（开发人员）</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_D_contribute_assets/">如何升级内容</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_D_create_sensor/">创建一个传感器</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_D_create_semantic_tags/">创建语义标签</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_D_customize_vehicle_suspension/">自定义车辆悬架</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_D_generate_colliders/">生成详细碰撞</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_D_make_release/">发布版本</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">CARLA 生态系统</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../ecosys_ansys/">Ansys 实时雷达模型</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">贡献</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../cont_contribution_guidelines/">贡献指南</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cont_code_of_conduct/">行为准则</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cont_coding_standard/">编码标准</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cont_doc_standard/">文档标准</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">CARLA 模拟器 中文文档</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">第一步</li>
      <li class="breadcrumb-item active">第二、 角色和蓝图</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="_1">参与者和蓝图</h1>
<p>Carla 中的参与者是在模拟中执行动作的元素，他们可以影响其他参与者。Carla 的参与者包括车辆和步行者，也包括传感器、交通标志、红绿灯和观看者。对如何操作它们有充分的了解是至关重要的。 </p>
<p>本节将介绍生成、摧毁、类型以及如何管理它们。然而，可能性几乎是无穷无尽的。实验、查看本文档中的 <strong>教程</strong>，并在 <a href="https://github.com/carla-simulator/carla/discussions/">Carla 论坛</a> 中分享疑虑和想法。</p>
<ul>
<li><a href="#blueprints"><strong>蓝图</strong></a>  <ul>
<li><a href="#managing-the-blueprint-library">管理蓝图库</a>  </li>
</ul>
</li>
<li><a href="#actor-life-cycle"><strong>参与者生命周期</strong></a>  <ul>
<li><a href="#spawning">生成</a>  </li>
<li><a href="#handling">处理</a>  </li>
<li><a href="#destruction">摧毁</a>  </li>
</ul>
</li>
<li><a href="#types-of-actors"><strong>参与者类型</strong></a>  <ul>
<li><a href="#sensors">传感器</a>  </li>
<li><a href="#spectator">观察者</a>  </li>
<li><a href="#traffic-signs-and-traffic-lights">交通标志和交通灯</a>  </li>
<li><a href="#vehicles">车辆</a>  </li>
<li><a href="#walkers">步行者</a>  </li>
</ul>
</li>
</ul>
<hr />
<h2 id="_2">蓝图</h2>
<p>这些布局允许用户将新的参与者平滑地结合到模拟中。它们已经是带有动画和一系列属性的模型。其中一些是可修改的，而另一些则不是。这些属性包括车辆颜色、激光雷达传感器中的通道数量、步行者的速度等等。</p>
<p><a href="../bp_library/">蓝图库</a> 列出了可用的蓝图及其属性。车辆和步行者蓝图具有一个生成属性，用于指示它们是新的（第2代）资产还是旧的（第1代）资产。</p>
<h3 id="_3">管理蓝图库</h3>
<p><a href="../python_api/#carla.BlueprintLibrary">carla.BlueprintLibrary</a> 类包含一系列 <a href="../python_api/#carla.ActorBlueprint">carla.ActorBlueprint</a> 元素。它是能够提供对它访问的世界对象。</p>
<pre><code class="language-py">blueprint_library = world.get_blueprint_library()
</code></pre>
<p>蓝图有一个 ID 来识别它们和由此产生的参与者。可以读取库来找到某个 ID，随机选择蓝图，或者使用 <a href="https://tldp.org/LDP/GNU-Linux-Tools-Summary/html/x11655.htm">通配符模式</a> 过滤结果。</p>
<pre><code class="language-py"># 找一个指定的蓝图
collision_sensor_bp = blueprint_library.find('sensor.other.collision')
# 随机选择一个车辆蓝图
vehicle_bp = random.choice(blueprint_library.filter('vehicle.*.*'))
</code></pre>
<p>除此之外，每个 <a href="../python_api/#carla.ActorBlueprint">carla.ActorBlueprint</a> 能获取 <em>get</em> 和改变 <em>set</em> 一些列参与者属性 <a href="../python_api/#carla.ActorAttribute">carla.ActorAttribute</a> 。</p>
<pre><code class="language-py">is_bike = [vehicle.get_attribute('number_of_wheels') == 2]
if(is_bike)
    vehicle.set_attribute('color', '255,0,0')
</code></pre>
<div class="admonition 注意">
<p class="admonition-title">注意</p>
<p>某些属性无法修改。在<a href="../bp_library/">蓝图库</a>中查看。</p>
</div>
<p>属性有一个参与者属性类型 <a href="../python_api/#carla.ActorAttributeType">carla.ActorAttributeType</a> 变量。它从枚举列表中声明其类型。此外，可修改的属性还附带一个 <strong>推荐值列表</strong> 。</p>
<pre><code class="language-py">for attr in blueprint:
    if attr.is_modifiable:
        blueprint.set_attribute(attr.id, random.choice(attr.recommended_values))
</code></pre>
<div class="admonition 注意">
<p class="admonition-title">注意</p>
<p>用户可以创建他们自己的车辆。查看 <strong>教程（资产）</strong> 以了解相关信息。贡献者可以 <a href="../tuto_D_contribute_assets/">将他们的新内容添加到 Carla</a> 。</p>
</div>
<hr />
<h2 id="_4">参与者生命周期</h2>
<div class="admonition 重要">
<p class="admonition-title">重要</p>
<p>本节提到了关于参与者的不同方法。Python API 提供 <strong><a href="../python_api/#command.SpawnActor">commands</a></strong> ，以便在一个框架中应用一批最常见的命令。 </p>
</div>
<h3 id="_5">生成</h3>
<p><strong>世界对象负责生成参与者并跟踪这些参与者。</strong> 生成只需要一张蓝图和一个 <a href="../python_api/#carla.Transform">carla.Transform</a> 说明参与者的位置和旋转。 </p>
<p>世界有两个不同的方法生成参与者。 </p>
<ul>
<li><a href="../python_api/#carla.World.spawn_actor"><code>spawn_actor()</code></a> 如果生成失败抛出一个异常。</li>
<li><a href="../python_api/#carla.World.try_spawn_actor"><code>try_spawn_actor()</code></a> 如果生成失败返回 <code>None</code>。</li>
</ul>
<pre><code class="language-py">transform = Transform(Location(x=230, y=195, z=40), Rotation(yaw=180))
actor = world.spawn_actor(blueprint, transform)
</code></pre>
<div class="admonition 重要">
<p class="admonition-title">重要</p>
<p>Carla 使用 <a href="https://carla.readthedocs.io/en/latest/python_api/#carlarotation">虚幻引擎坐标系统</a> 。记住： <a href="https://carla.readthedocs.io/en/latest/python_api/#carlarotation"><code>carla.Rotation</code></a> 构造函数定义为“俯仰、偏航、翻滚” <code>(pitch, yaw, roll)</code>，与虚幻编辑器的“翻滚、俯仰、偏航” <code>(roll, pitch, yaw)</code> 不同。</p>
</div>
<p>如果在指定位置发生冲突，将不会生成参与者。无论这种情况发生在静态对象还是其他参与者身上。可以尝试避免这些不希望的生成碰撞。</p>
<ul>
<li><code>map.get_spawn_points()</code> <strong>对于车辆</strong>。 返回推荐生成点的列表。</li>
</ul>
<pre><code class="language-py">spawn_points = world.get_map().get_spawn_points()
</code></pre>
<ul>
<li><code>world.get_random_location()</code> <strong>对于行人</strong>。 返回人行道上的随机点。同样的方法也用于为行人设置目标位置。  </li>
</ul>
<pre><code class="language-py">spawn_point = carla.Transform()
spawn_point.location = world.get_random_location_from_navigation()
</code></pre>
<p>一个参与者在生成时可以附加到另一个参与者上。参与者跟随他们所依附的父级。这对于传感器特别有用。该附件可以是刚性的（适合检索精确数据），也可以根据其父级的情况进行轻松移动。它由辅助类 <a href="../python_api/#carla.AttachmentType">carla.AttachmentType</a> 定义。</p>
<p>下一个示例将相机刚性地连接到车辆上，因此它们的相对位置保持固定。</p>
<pre><code class="language-py">camera = world.spawn_actor(camera_bp, relative_transform, attach_to=my_vehicle, carla.AttachmentType.Rigid)
</code></pre>
<div class="admonition 重要">
<p class="admonition-title">重要</p>
<p>当生成附加的参与者时，提供的变换必须相对于父级参与者。</p>
</div>
<p>一旦生成，世界对象就会将参与者添加到列表中。这可以很容易地搜索或迭代。 </p>
<pre><code class="language-py">actor_list = world.get_actors()
# 根据 id 找参与者
actor = actor_list.find(id)
# 打印世界上所有限速标志的位置。
for speed_sign in actor_list.filter('traffic.speed_limit.*'):
    print(speed_sign.get_location())
</code></pre>
<h3 id="_6">处理</h3>
<p><a href="../python_api/#carla.Actor">carla.Actor</a> 主要由  <em>get()</em> 和 <em>set()</em> 方法组成，用于管理地图周围的参与者。</p>
<pre><code class="language-py">print(actor.get_acceleration())
print(actor.get_velocity())

location = actor.get_location()
location.z += 10.0
actor.set_location(location)
</code></pre>
<p>可以禁用演员的物理特性以将其冻结在适当的位置。</p>
<pre><code class="language-py">actor.set_simulate_physics(False)
</code></pre>
<p>除此之外，参与者还有他们的蓝图提供的标签。这些对于语义分割传感器最有用。</p>
<div class="admonition 警告">
<p class="admonition-title">警告</p>
<p>大多数方法是异步向模拟器发送请求。模拟器每次更新解析它们的时间有限。使用 <em>set()</em> 方法淹没模拟器将积累明显的延迟。</p>
</div>
<h3 id="_7">摧毁</h3>
<p>当 Python 脚本完成时，参与者不会被销毁。他们必须明确地摧毁自己。</p>
<pre><code class="language-py">destroyed_sucessfully = actor.destroy() # 如果成功返回 True 
</code></pre>
<div class="admonition 重要">
<p class="admonition-title">重要</p>
<p>销毁参与者会阻塞模拟器，直到该过程完成。</p>
</div>
<hr />
<h2 id="_8">参与者类型</h2>
<h3 id="_9">传感器</h3>
<p>传感器是产生数据流的参与者。他们有自己的部分，<a href="../core_sensors/">第四部分. 传感器和数据</a>。现在，我们只看一下常见的传感器生成周期。</p>
<p>此示例生成一个相机传感器，将其连接到车辆，并告诉相机将生成的图像保存到磁盘。</p>
<pre><code class="language-py">camera_bp = blueprint_library.find('sensor.camera.rgb')
camera = world.spawn_actor(camera_bp, relative_transform, attach_to=my_vehicle)
camera.listen(lambda image: image.save_to_disk('output/%06d.png' % image.frame))
</code></pre>
<ul>
<li>传感器也有蓝图。设置属性至关重要。 </li>
<li>大多数传感器将安装在车辆上以收集周围环境的信息。</li>
<li>传感器 <strong>监听</strong> 数据。收到数据后，它们会调用用 <strong><a href="https://docs.python.org/3/reference/expressions.html">Lambda 表达式</a></strong> 描述的函数<small>(提供的链接中的 6.14)</small>。 </li>
</ul>
<h3 id="_10">观察者</h3>
<p>由虚幻引擎放置以提供游戏内的视角。它可用于移动模拟器窗口的视角。以下示例将移动观众演员，将视角指向所需的车辆。</p>
<pre><code class="language-py">spectator = world.get_spectator()
transform = vehicle.get_transform()
spectator.set_transform(carla.Transform(transform.location + carla.Location(z=50),
carla.Rotation(pitch=-90)))

</code></pre>
<h3 id="_11">交通标志和交通灯</h3>
<p>到目前为止，Carela 中只有停靠点、让行路线和交通信号灯被视为参与者。其余的 OpenDRIVE 标志可通过 API 作为地标（<a href="../python_api/#carla.Landmark"><strong>carla.Landmark</strong></a>）进行访问。他们的信息可以使用这些实例访问，但他们在模拟中并不作为参与者存在。在接下来的 <strong>第 3 部分 地图和导航</strong> 中将更详细地解释地标。 </p>
<p>当模拟开始、停止、让行和交通灯时，会使用 OpenDRIVE 文件中的信息自动生成。<strong>这些都无法在蓝图库中找到</strong>，因此无法生成。</p>
<div class="admonition 注意">
<p class="admonition-title">注意</p>
<p>OpenDRIVE 文件中的 Carela 地图没有交通标志或信号灯。这些是由开发人员手动放置的。 </p>
</div>
<p><a href="../python_api/#carla.TrafficSign"><strong>交通标志</strong></a> 未在路线图本身中定义，如下页所述。相反，他们有一个 <a href="../python_api/#carla.BoundingBox">carla.BoundingBox</a> 来影响其中的车辆。 </p>
<pre><code class="language-py"># 获得影响车辆的交通灯
if vehicle_actor.is_at_traffic_light():
    traffic_light = vehicle_actor.get_traffic_light()
</code></pre>
<p>路口设有<a href="../python_api/#carla.TrafficLight"><strong>交通灯</strong></a>。与任何参与者一样，他们有自己独特的 ID，但对于岔路口也有一个组（<code>group</code>） ID 。</p>
<p>同一组中的交通灯遵循一个循环。第一个设置为绿色，而其余的则保持红色。活跃的灯会持续几秒钟呈绿色、黄色和红色，因此有一段时间所有灯都是红色的。然后，下一个红绿灯开始循环，前一个红绿灯与其余红绿灯一起冻结。</p>
<p>可以使用 API 设置交通灯的状态。每个状态花费的秒数也是如此。可能的状态用 <a href="../python_api/#carla.TrafficLightState">carla.TrafficLightState</a> 描述为一系列枚举值。</p>
<pre><code class="language-py"># 交通灯从红变绿
if traffic_light.get_state() == carla.TrafficLightState.Red:
    traffic_light.set_state(carla.TrafficLightState.Green)
    traffic_light.set_set_green_time(4.0)
</code></pre>
<div class="admonition 注意">
<p class="admonition-title">注意</p>
<p>只有当信号灯为红色时，车辆才会意识到交通灯。</p>
</div>
<h3 id="_12">车辆</h3>
<p><a href="../python_api/#carla.Vehicle"><strong>carla.Vehicle</strong></a> 是一种特殊类型的演员。它采用了仿真轮式车辆物理特性的特殊内部组件。这是通过应用四种不同的控件来实现的：</p>
<ul>
<li><strong><a href="../python_api/#carla.VehicleControl">carla.VehicleControl</a></strong> 提供油门、转向、刹车等驾驶命令的输入。</li>
</ul>
<pre><code class="language-py">    vehicle.apply_control(carla.VehicleControl(throttle=1.0, steer=-1.0))
</code></pre>
<ul>
<li>
<p><strong><a href="../python_api/#carla.VehiclePhysicsControl">carla.VehiclePhysicsControl</a></strong> 定义车辆的物理属性并包含另外两个控制器：</p>
<ul>
<li><a href="../python_api/#carla.GearPhysicsControl">carla.GearPhysicsControl</a> 控制齿轮。</li>
<li><a href="../python_api/#carla.WheelPhysicsControl">carla.WheelPhysicsControl</a> 提供对每个轮子的特定控制。</li>
</ul>
</li>
</ul>
<pre><code class="language-py">    vehicle.apply_physics_control(carla.VehiclePhysicsControl(max_rpm = 5000.0, center_of_mass = carla.Vector3D(0.0, 0.0, 0.0), torque_curve=[[0,400],[5000,400]]))
</code></pre>
<p>车辆有一个 <a href="../python_api/#carla.BoundingBox">carla.BoundingBox</a> 封装它们。该边界框允许将物理原理应用于车辆并检测碰撞。</p>
<pre><code class="language-py">    box = vehicle.bounding_box
    print(box.location)         # 相对车辆的位置
    print(box.extent)           # XYZ half-box extents in meters.
</code></pre>
<p>通过启用 <a href="https://carla.readthedocs.io/en/latest/python_api/#carla.VehiclePhysicsControl.use_sweep_wheel_collision">sweep wheel collision parameter</a> 扫轮碰撞参数可以改善车轮的物理特性。默认的轮子物理系统对每个轮子使用从轴到地板的单射线投射，但是当启用扫掠轮碰撞时，将检查轮子的整个体积是否发生碰撞。它可以这样启用：
The physics of vehicle wheels can be improved by enabling the <a href="https://carla.readthedocs.io/en/latest/python_api/#carla.VehiclePhysicsControl.use_sweep_wheel_collision">sweep wheel collision parameter</a>. The default wheel physics uses single ray casting from the axis to the floor for each wheel but when sweep wheel collision is enabled, the full volume of the wheel is checked against collisions. It can be enabled as such:</p>
<pre><code class="language-py">    physics_control = vehicle.get_physics_control()
    physics_control.use_sweep_wheel_collision = True
    vehicle.apply_physics_control(physics_control)
</code></pre>
<p>Vehicles include other functionalities unique to them:</p>
<ul>
<li><strong>Autopilot mode</strong> will subscribe a vehicle to the <a href="../adv_traffic_manager/">Traffic Manager</a> to simulate real urban conditions. This module is hard-coded, not based on machine learning.  </li>
</ul>
<pre><code class="language-py">    vehicle.set_autopilot(True)
</code></pre>
<ul>
<li><strong>Vehicle lights</strong> have to be turned on and off by the user. Each vehicle has a set of lights listed in <a href="../python_api/#carla.VehicleLightState"><strong>carla.VehicleLightState</strong></a>. Not all vehicles have lights integrated. At the time of writing, vehicles with integrated lights are as follows:  <ul>
<li><strong>Bikes:</strong> All bikes have a front and back position light.  </li>
<li><strong>Motorcycles:</strong> Yamaha and Harley Davidson models.  </li>
<li><strong>Cars:</strong> Audi TT, Chevrolet Impala, both Dodge police cars, Dodge Charger, Audi e-tron, Lincoln 2017 and 2020, Mustang, Tesla Model 3, Tesla Cybertruck, Volkswagen T2 and the Mercedes C-Class.  </li>
</ul>
</li>
</ul>
<p>The lights of a vehicle can be retrieved and updated anytime using the methods <a href="../python_api/#carla.Vehicle.get_light_state">carla.Vehicle.get_light_state</a> and <a href="#python_api.md#carla.Vehicle.set_light_state">carla.Vehicle.set_light_state</a>. These use binary operations to customize the light setting.  </p>
<pre><code class="language-py"># Turn on position lights
current_lights = carla.VehicleLightState.NONE
current_lights |= carla.VehicleLightState.Position
vehicle.set_light_state(current_lights)
</code></pre>
<h3 id="walkers">Walkers</h3>
<p><a href="../python_api/#carla.Walker"><strong>carla.Walker</strong></a> work in a similar way as vehicles do. Control over them is provided by controllers.  </p>
<ul>
<li><a href="../python_api/#carla.WalkerControl"><strong>carla.WalkerControl</strong></a> moves the pedestrian around with a certain direction and speed. It also allows them to jump. </li>
<li><a href="../python_api/#carla.WalkerBoneControl"><strong>carla.WalkerBoneControl</strong></a> provides control over the 3D skeleton. <a href="../tuto_G_control_walker_skeletons/">This tutorial</a> explains how to control it. </li>
</ul>
<p>Walkers can be AI controlled. They do not have an autopilot mode. The <a href="../python_api/#carla.WalkerAIController"><strong>carla.WalkerAIController</strong></a> actor moves around the actor it is attached to.  </p>
<pre><code class="language-py">walker_controller_bp = world.get_blueprint_library().find('controller.ai.walker')
world.SpawnActor(walker_controller_bp, carla.Transform(), parent_walker)
</code></pre>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The AI controller is bodiless and has no physics. It will not appear on scene. Also, location <code>(0,0,0)</code> relative to its parent will not cause a collision.  </p>
</div>
<p><strong>Each AI controller needs initialization, a goal and, optionally, a speed</strong>. Stopping the controller works in the same manner. </p>
<pre><code class="language-py">ai_controller.start()
ai_controller.go_to_location(world.get_random_location_from_navigation())
ai_controller.set_max_speed(1 + random.random())  # Between 1 and 2 m/s (default is 1.4 m/s).
...
ai_controller.stop()
</code></pre>
<p>When a walker reaches the target location, they will automatically walk to another random point. If the target point is not reachable, walkers will go to the closest point from their current location.</p>
<p>A snipet in <a href="../python_api/#carla.Client.apply_batch_sync">carla.Client</a> uses batches to spawn a lot of walkers and make them wander around.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p><strong>To destroy AI pedestrians</strong>, stop the AI controller and destroy both, the actor, and the controller. </p>
</div>
<hr />
<p>That is a wrap as regarding actors in CARLA. The next step takes a closer look into the map, roads and traffic in CARLA.  </p>
<p>Keep reading to learn more or visit the forum to post any doubts or suggestions that have come to mind during this reading. </p>
<div text-align: center>
<div class="build-buttons">
<p>
<a href="https://github.com/carla-simulator/carla/discussions/" target="_blank" class="btn btn-neutral" title="CARLA forum">
CARLA forum</a>
</p>
</div>
<div class="build-buttons">
<p>
<a href="../core_map" target="_blank" class="btn btn-neutral" title="3rd. Maps and navigation">
3rd. Maps and navigation</a>
</p>
</div>
</div>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../core_world/" class="btn btn-neutral float-left" title="第一、 世界和客户端"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../core_map/" class="btn btn-neutral float-right" title="第三、地图和导航 ">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../core_world/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../core_map/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../extra.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
