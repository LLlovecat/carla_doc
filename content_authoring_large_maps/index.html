<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Creating Large Maps for CARLA - CARLA 模拟器 中文文档</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../extra.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Creating Large Maps for CARLA";
        var mkdocs_page_input_path = "content_authoring_large_maps.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> CARLA 模拟器 中文文档
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">主页</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">入门</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../start_introduction/">介绍</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../start_quickstart/">快速启动包安装</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">构建CARLA</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../build_linux/">Linux build</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../build_windows/">Windows build</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../build_update/">Update CARLA</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../build_system/">Build system</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../build_docker/">CARLA in Docker</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../build_faq/">F.A.Q.</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">第一步</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../core_concepts/">核心概念</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../core_world/">第一、 世界和客户端</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../core_actors/">第二、 角色和蓝图</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../core_map/">第三、地图和导航 </a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../core_sensors/">第四、 传感器和数据</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">高级概念</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_opendrive/">OpenDRIVE 独立模式</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_ptv/">PTV-Vissim 联合仿真</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_recorder/">Recorder</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_rendering_options/">渲染选项</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_rss/">RSS</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_synchrony_timestep/">同步和时间步长</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_benchmarking/">基准性能</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_agents/">CARLA 代理</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">交通模拟</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../ts_traffic_simulation_overview/">交通模拟概述</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_traffic_manager/">Traffic Manager</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_sumo/">SUMO 联合仿真</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_scenic/">Scenic</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">参考</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../python_api/">Python API 参考</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../bp_library/">Blueprint Library</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ref_cpp/">C++ 参考</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ref_recorder_binary_file_format/">Recorder 二进制文件格式</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ref_sensors/">Sensors reference</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">插件</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../plugins_carlaviz/">carlaviz — web 可视化器</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">ROS 桥接器</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../ros_documentation/">ROS 桥文档</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">自定义地图</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_custom_map_overview/">CARLA 中自定义地图的概述</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_generate_map/">在 RoadRunner 中创建地图</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_add_map_package/">在CARLA包导入地图</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_add_map_source/">在 CARLA 源构建中导入地图</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_add_map_alternative/">导入地图的替代方法</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_manual_map_package/">手动准备地图包</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_custom_layers/">自定义地图：分层地图: Layered maps</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_custom_add_tl/">自定义地图：红绿灯和标志</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_custom_road_painter/">自定义地图：Road painter</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_custom_buildings/">自定义地图：程序建筑</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_custom_weather_landscape/">自定义地图：天气和景观</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_generate_pedestrian_navigation/">生成行人导航</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">大型地图</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../large_map_overview/">大型地图概述</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../large_map_roadrunner/">在RoadRunner中创建大地图</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../large_map_import/">导入/打包大地图</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">教程（通用）</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_add_friction_triggers/">添加摩擦触发器</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_control_vehicle_physics/">控制车辆物理模型</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_control_walker_skeletons/">控制行人骨骼</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_openstreetmap/">使用OpenStreetMap生成地图</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_retrieve_data/">检索模拟数据</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_carsim_integration/">CarSim 集成</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_rllib_integration/">RLlib 集成</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_chrono/">Chrono 集成</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../build_docker_unreal/">在 Docker 中构建虚幻引擎UE和 CARLA</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">教程（资产）</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_A_add_vehicle/">添加新车辆</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_A_add_props/">添加新道具</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_A_create_standalone/">创建独立包</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_A_material_customization/">材料定制</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">教程（开发人员）</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_D_contribute_assets/">如何升级内容</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_D_create_sensor/">创建一个传感器</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_D_create_semantic_tags/">创建语义标签</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_D_customize_vehicle_suspension/">自定义车辆悬架</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_D_generate_colliders/">生成详细碰撞</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_D_make_release/">发布版本</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">CARLA 生态系统</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../ecosys_ansys/">Ansys 实时雷达模型</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">贡献</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../cont_contribution_guidelines/">贡献指南</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cont_code_of_conduct/">行为准则</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cont_coding_standard/">编码标准</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cont_doc_standard/">文档标准</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">CARLA 模拟器 中文文档</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">Creating Large Maps for CARLA</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="creating-large-maps-for-carla">Creating Large Maps for CARLA</h1>
<p>Large Maps (like Towns 11 and 12) operate in a different way to standard maps (like Town 10) in CARLA. The map is divided up into tiles, which are subdivisions of the map, that are normally set to be about 1 to 2 km in size. The tiles divide up the map such that only the parts of the map that are needed are loaded into graphics memory for efficient rendering. The unneeded tiles remain dormant and ready to be loaded when they are required. Normally the tiles next to the tile in the location of the ego vehicle are loaded, but more tiles can be loaded if necessary. This behavior can be modified in the settings when CARLA is launched.</p>
<h1 id="create-a-large-map-in-roadrunner">Create a Large Map in RoadRunner</h1>
<p>RoadRunner is the recommended software to create Large Maps to be imported into CARLA. This guide outlines how to use RoadRunner for creating Large Maps and how to import and handle the Large Map in the Unreal Engine editor.</p>
<ul>
<li><a href="#build-a-large-map-in-roadrunner"><strong>Build a Large Map in RoadRunner</strong></a></li>
<li><a href="#export-a-large-map-in-roadrunner"><strong>Export a Large Map in RoadRunner</strong></a></li>
<li><a href="#import-a-large-map-into-carla"><strong>Import a Large Map into CARLA</strong></a><ul>
<li><a href="#files-and-folders">Files and folders</a></li>
<li><a href="#create-the-json-description-optional">Create the JSON description (Optional)</a></li>
<li><a href="#making-the-import">Making the import</a></li>
</ul>
</li>
<li><a href="#handling-a-large-map-in-the-unreal-editor"><strong>Handling a Large Map in the Unreal Editor</strong></a></li>
<li><a href="#package-a-large-map"><strong>Package a Large Map</strong></a></li>
</ul>
<hr />
<h2 id="build-a-large-map-in-roadrunner">Build a Large Map in RoadRunner</h2>
<p>The specifics of how to build a complex map in RoadRunner go beyond the scope of this guide, however, there are video tutorials available in the <a href="https://www.mathworks.com/support/search.html?fq=asset_type_name:video%20category:roadrunner/index&amp;page=1&amp;s_tid=CRUX_topnav">RoadRunner documentation</a>. On the face of it, building a Large Map in RoadRunner is largely the same as building a standard map, just bigger in scale. The differences are largely in how the map is exported.</p>
<p><img alt="roadrunner_draw" src="../img/tuto_content_authoring_maps/large_map_roadrunner.png" /></p>
<p>Here we have created a Large Map of about 1.2 km in size. This will be broken up into tiles when we export it, we will choose a tile size of 700m, so the map should split up into around 4 tiles. </p>
<p>If you are building a Large Map with elevation, the recommended largest size of the map is 20x20 km<sup>2</sup>. Maps larger than this may cause RoadRunner to crash on export.</p>
<hr />
<h2 id="export-a-large-map-in-roadrunner">Export a Large Map in RoadRunner</h2>
<p>Below is a basic guideline to export your custom Large Map from RoadRunner.</p>
<p>Make sure the full map is selected for export by clicking on the <a href="https://www.mathworks.com/help/roadrunner/ref/worldsettingstool.html"><em>World settings tool</em></a> and dragging the edges of the blue boundary box to encompass the full area you would like to export. when it's ready, click on <em>Apply World Changes</em>.</p>
<p><img alt="roadrunner_workspace" src="../img/tuto_content_authoring_maps/roadrunner_workspace.png" /></p>
<p>It is helpful to use the scene export preview tool to understand how your map will be divided up into tiles for export. Adjust the <em>Tile Size</em> parameters in the <em>Tiling Options</em> menu to find a suitable tile size for your map, press <em>Refresh Scene</em> to see the impact of your adjustments.</p>
<p><img alt="roadrunner_scene_preview" src="../img/tuto_content_authoring_maps/rr_scene_export_preview.png" /></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Tile size</strong>: The size of the tiles you use is a judgement call needed to ensure that the map will work efficiently when used in CARLA. If your map will be dense in 3D assets like buildings and vegetation, you may benefit from a smaller tile size to prevent the loading of unnecessary assets. This may, however, increase the complexity of the work needed to build your map. The maximum tile size supported by the CARLA engine is 2 km, we recommend tiles of around 1 km in size. </p>
</div>
<p>When you are ready to export:</p>
<p><strong>1.</strong> Export the <code>.fbx</code> geometry files:</p>
<ul>
<li>In the main toolbar, select <code>File</code> -&gt; <code>Export</code> -&gt; <code>Firebox (.fbx)</code></li>
</ul>
<p><strong>2.</strong> In the window that pops up:</p>
<blockquote>
<ul>
<li>Check the following options:<ul>
<li><em>Split by Segmentation</em>: Divides the mesh by semantic segmentation and improves pedestrian navigation.</li>
<li><em>Power of Two Texture Dimensions</em>: Improves performance.</li>
<li><em>Embed Textures</em>: Ensures textures are embedded in the mesh.</li>
<li><em>Export to Tiles</em>: Choose the size of the tiles. The maximum size that can be used by CARLA is 2000 x 2000.</li>
<li><em>Export Individual Tiles</em>: Generates the individual tiles needed for streaming Large Maps in CARLA.</li>
</ul>
</li>
</ul>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<p><img alt="export_large_map_fbx" src="../img/tuto_content_authoring_maps/rr_export.png" /></p>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
<p><strong>3.</strong> Export the <code>.xodr</code> OpenDrive map file:</p>
<ul>
<li>In the main toolbar, select <code>File</code> -&gt; <code>Export</code> -&gt; <code>OpendDRIVE (.xodr)</code></li>
</ul>
<p>In the folder you chose for export, you will now have several new files, one <code>.xodr</code> file and several <code>.fbx</code> files:</p>
<p><img alt="export_large_map_fbx" src="../img/tuto_content_authoring_maps/large_map_export.png" /></p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Make sure that the <code>.xodr</code> and the <code>.fbx</code> files have the same name root.</p>
</div>
<p>Now you've created your Large Map in Roadrunner, you are ready to import it into CARLA. The files that RoadRunner has created should be shifted to the <code>Import</code> directory inside the root of the directory you are using to build CARLA. </p>
<hr />
<h1 id="import-a-large-map-into-carla">Import a Large Map into CARLA</h1>
<p>Large Maps generated in RoadRunner can be imported into the source build of CARLA and packaged for distribution and usage in a CARLA standalone package. The process is very similar to that of standard maps with the addition of specific nomenclature for tiles and batch importing.</p>
<h2 id="files-and-folders">Files and folders</h2>
<p>All files to be imported should be placed in the <code>Import</code> folder of the root CARLA directory. These files should include:</p>
<ul>
<li>The mesh of the map in multiple <code>.fbx</code> files representing different tiles of the map.</li>
<li>The OpenDRIVE definition in a single <code>.xodr</code> file.</li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>You cannot import Large Maps and standard maps at the same time.</p>
</div>
<p>The naming convention of map tiles is very important. Each map tile should be named according to the following convention:</p>
<pre><code>&lt;mapName&gt;_Tile_&lt;x-coordinate&gt;_&lt;y-coordinate&gt;.fbx
</code></pre>
<p>RoadRunner should conform to this naming convention by default, but it's worth double checking before you prepare to import into CARLA, because problems caused at this stage can be tedious to fix later on. The tiles in the final map will be arranged like in the following diagram:</p>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<p><img src="./img/tuto_content_authoring_maps/large_map_tiles.png" width="70%"></p>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
<p>A resulting <code>Import</code> folder with a package containing a Large Map made of four tiles should have a structure similar to the one below:</p>
<pre><code class="language-sh">Import
│
└── Package01
  ├── Package01.json
  ├── LargeMap_Tile_0_0.fbx
  ├── LargeMap_Tile_0_1.fbx
  ├── LargeMap_Tile_1_0.fbx
  ├── LargeMap_Tile_1_1.fbx
  └── LargeMap.xodr

</code></pre>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code>package.json</code> file is not strictly necessary. If there is no <code>package.json</code> file created, the automated import process will create one. Find out more about to structure your own <code>package.json</code> in the next section.</p>
</div>
<hr />
<h2 id="create-the-json-description-optional">Create the JSON description (Optional)</h2>
<p>The <code>.json</code> description is created automatically during the import process, but there is also the option to create one manually. An existing <code>.json</code> description will override any values passed as arguments in the import process.</p>
<p>The <code>.json</code> file should be created in the root folder of the package. The file name will be the package distribution name. The content of the file describes a JSON array of <strong>maps</strong> and <strong>props</strong> with basic information for each one.</p>
<p><strong>Maps</strong> need the following parameters:</p>
<ul>
<li><strong>name:</strong> Name of the map. This must be the same as the <code>.fbx</code> and <code>.xodr</code> files.</li>
<li><strong>xodr:</strong> Path to the <code>.xodr</code> file.</li>
<li><strong>use_carla_materials:</strong> If <strong>True</strong>, the map will use CARLA materials. Otherwise, it will use RoadRunner materials.</li>
<li><strong>tile_size:</strong> The size of the tiles. Default value is 2000 (2kmx2km).</li>
<li><strong>tiles:</strong> A list of the <code>.fbx</code> tile files that make up the entire map.</li>
</ul>
<p><strong>Props</strong> are not part of this tutorial. Please see <a href="../tuto_A_add_props/">this</a> tutorial for how to add new props.</p>
<p>The resulting <code>.json</code> file should resemble the following:</p>
<pre><code class="language-json">{
  &quot;maps&quot;: [
      {
        &quot;name&quot;: &quot;LargeMap&quot;,
        &quot;xodr&quot;: &quot;./LargeMap.xodr&quot;,
        &quot;use_carla_materials&quot;: true,
        &quot;tile_size&quot;: 700,
        &quot;tiles&quot;: [ 
        &quot;./LargeMap_Tile_0_0.fbx&quot;,
        &quot;./LargeMap_Tile_0_1.fbx&quot;,
        &quot;./LargeMap_Tile_1_0.fbx&quot;,
        &quot;./LargeMap_Tile_1_1.fbx&quot;
        ]
      }
  ],
  &quot;props&quot;: []
}
</code></pre>
<p></details>
<br></p>
<hr />
<h2 id="making-the-import">Making the import</h2>
<p>When all files have been placed in the <code>Import</code> folder, run the following command in the root CARLA folder:</p>
<pre><code class="language-sh">make import
</code></pre>
<p>Depending on your system, Unreal Engine may consume too much memory to be able to import all files at once. You can choose to import the files in batches of MB by running the command:</p>
<pre><code class="language-sh">make import ARGS=&quot;--batch-size=200&quot;
</code></pre>
<p>Two more flags exist for the <code>make import</code> command:</p>
<ul>
<li><code>--package=&lt;package_name&gt;</code> specifies the name of the package. By default, this is set to <code>map_package</code>. Two packages cannot have the same name, so using the default value will lead to errors on a subsequent ingestion. <strong>It is highly recommended to change the name of the package</strong>. Use this flag by running the command:</li>
</ul>
<pre><code class="language-sh">make import  ARGS=&quot;--package=&lt;package_name&gt;&quot;
</code></pre>
<ul>
<li><code>--no-carla-materials</code> specifies that you do not want to use the default CARLA materials (road textures etc). You will use the RoadRunner materials instead. This flag is <strong>only required if you are not</strong> providing your own <a href="../tuto_M_manual_map_package/"><code>.json</code> file</a>. Any value in the <code>.json</code> file will override this flag. Use this flag by running the command:</li>
</ul>
<pre><code class="language-sh">make import  ARGS=&quot;--no-carla-materials&quot;
</code></pre>
<p>All files will be imported and prepared to be used in the Unreal Editor. The map package will be created in <code>Unreal/CarlaUE4/Content</code>. A base map tile, <code>&lt;mapName&gt;</code>, will be created as a streaming level for all the tiles. The base tile will contain the sky, weather, and Large Map actors and will be ready for use in a simulation.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is currently not recommended to use the customization tools provided for standard maps in the Unreal Editor, e.g., road painter, procedural buildings, etc.</p>
</div>
<hr />
<h2 id="handling-a-large-map-in-the-unreal-editor">Handling a Large Map in the Unreal Editor</h2>
<p>Now that you have imported your new map, you will find the map in the content browser inside a folder that will be named <code>map_package</code> by default. The folder will have an alternative name if you used the <code>"--package=&lt;package_name&gt;"</code> argument with the import command. Inside this folder, open the <code>Maps</code> folder and open the folder inside this one. Inside you will find several <em>level</em> files that are coloured orange. </p>
<p><img alt="export_large_map_fbx" src="../img/tuto_content_authoring_maps/tiles_content_browser.png" /></p>
<p>There will be one level file one for the whole map and one level file for each tile you exported from RoadRunner. To add assets to the map like buildings and vegetation, double click on the level file for the tile that you want to work on (e.g. in this example <code>LargeMap_Tile_0_0</code>) in order to load it in the editor. The tiles don't have any lighting settings by default, so you may need to change the view mode from <code>Lit</code> to <code>Unlit</code> to be able to see your tile once you have loaded it. Now you can follow the <a href="../tuto_content_authoring_maps/#importing-assets-and-adding-them-to-the-map">same procedure as for standard maps</a> to add details to your map, make sure to save the modifications you make to the tile you are working on, then load the next tile and repeat the procedure. You cannot work on the entire map in one go, so loading (by double clicking) the level file for the entire map (the file that is not followed by the suffix <code>_Tile_X_Y</code>) will not be useful for decorating the map.</p>
<p><img alt="export_large_map_fbx" src="../img/tuto_content_authoring_maps/large_map_unreal.png" /></p>
<hr />
<h2 id="loading-the-whole-map-and-running-the-simulation">Loading the whole map and running the simulation</h2>
<p>If you would like to load the map and start the simulation for experimentation you should load the level file for the whole map. Double click on the level file with the root map name (the file that is not followed by the suffix <code>_Tile_X_Y</code>) and wait for it to load. Loading can sometimes take a few seconds or even minutes for very large maps. Once it has loaded click on the <em>play</em> option in the Unreal Editor toolbar. The simulation will now start with your new Large Map.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you are running the simulation from the Unreal Engine editor for the first time it is recommended to first load each of the tiles (by double clicking on them) one by one until you have loaded all of them, prior to starting the simulation. This performs certain operations <em>in the background</em> like baking the Mesh Distance Fields and shaders for the tile. If you don't load the tiles one by one at first, these operations may be performed at runtime and this could lead to hangs or crashes in Unreal Engine.</p>
</div>
<h2 id="package-a-large-map">Package a Large Map</h2>
<p>To package your Large Map so it can be used in the CARLA standalone package follow the same procedure as for standard maps - run the following command:</p>
<pre><code class="language-sh">make package ARGS=&quot;--packages=&lt;mapPackage&gt;&quot;
</code></pre>
<p>This will create a standalone package compressed in a <code>.tar.gz</code> file. The files will be saved in the <code>Dist</code> folder on Linux, and <code>/Build/UE4Carla/</code> on Windows. They can then be distributed and packaged to use in standalone CARLA packages.</p>
<hr />
<p>If you have any questions about the Large Map import and packaging process, then you can ask in the <a href="https://github.com/carla-simulator/carla/discussions">forum</a>.</p>
<div class="build-buttons">
<p>
<a href="https://github.com/carla-simulator/carla/discussions" target="_blank" class="btn btn-neutral" title="Go to the CARLA forum">
CARLA forum</a>
</p>
</div>
              
            </div>
          </div><footer>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../extra.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
