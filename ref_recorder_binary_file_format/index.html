<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>记录器二进制文件格式 - 驾驶仿真器文档</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../extra.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "\u8bb0\u5f55\u5668\u4e8c\u8fdb\u5236\u6587\u4ef6\u683c\u5f0f";
        var mkdocs_page_input_path = "ref_recorder_binary_file_format.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> 驾驶仿真器文档
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">主页</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">入门</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../start_introduction/">介绍</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../start_quickstart/">快速启动包安装</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_first_steps/">第一步</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">构建 Carla</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../build_carla/">构建 Carla</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../build_linux/">Linux 构建</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../build_windows/">Windows 构建</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../build_update/">更新 Carla</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../build_system/">构建系统</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../build_docker/">Docker 中的 Carla</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../build_faq/">常问的问题</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">下一步</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_content_authoring_maps/">内容创作 - 地图</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_content_authoring_vehicles/">内容创作 - 车辆</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Carla 主题</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../foundations/">基础</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../core_concepts/">核心概念</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../core_world/">世界和客户端</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../core_actors/">参与者和蓝图</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../core_map/">地图和导航 </a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../core_sensors/">传感器和数据</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ts_traffic_simulation_overview/">交通</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../development_tutorials/">开发</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../custom_assets_tutorials/">自定义资产</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">高级概念</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_recorder/">记录器</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_rendering_options/">渲染选项</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_synchrony_timestep/">同步和时间步长</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_benchmarking/">基准性能</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_agents/">Carla 智能体</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">交通仿真</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_traffic_manager/">交通管理器</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_sumo/">SUMO 联合仿真</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_scenic/">Scenic</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">资源</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../python_api/">Python API 参考</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ref_cpp/">C++ 参考</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../bp_library/">蓝图库</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../catalogue/">Carla 目录</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="./">记录器二进制文件格式</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#1-">1- 二进制字符串</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#2-">2- 信息头</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#3-">3- 数据包</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#0-">数据包 0 - 帧开始</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#1-_1">数据包 1 - 帧结束</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#2-_1">数据包 2 - 事件添加</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#3-_1">数据包 3 - 事件删除</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#4-">数据包 4 - 事件父级</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#5-event-collision">数据包 5 - Event Collision</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#6-position">数据包 6 - Position</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#7-trafficlight">数据包 7 - TrafficLight</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#8-vehicle-animation">数据包 8 - Vehicle animation</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#9-walker-animation">数据包 9 - Walker animation</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#4-frame-layout">4- Frame Layout</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#5-file-layout">5- File Layout</a>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ref_sensors/">传感器参考</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tutorials/">教程</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ext_docs/">扩展文档</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">插件</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../plugins_carlaviz/">carlaviz — web 可视化器</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">ROS 桥接器</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../ros_documentation/">ROS 桥文档</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">自定义地图</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_custom_map_overview/">Carla 中自定义地图的概述</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_generate_map/">在 RoadRunner 中创建地图</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_add_map_package/">在CARLA包导入地图</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_add_map_source/">在 Carla 源构建中导入地图</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_add_map_alternative/">导入地图的替代方法</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_manual_map_package/">手动准备地图包</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_custom_layers/">自定义地图：分层地图: Layered maps</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_custom_add_tl/">自定义地图：红绿灯和标志</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_custom_road_painter/">自定义地图：Road painter</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_custom_buildings/">自定义地图：程序建筑</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_custom_weather_landscape/">自定义地图：天气和景观</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_generate_pedestrian_navigation/">生成行人导航</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">大型地图</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../large_map_overview/">大型地图概述</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../large_map_roadrunner/">在RoadRunner中创建大地图</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../large_map_import/">导入/打包大地图</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">教程（通用）</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_add_friction_triggers/">添加摩擦触发器</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_control_vehicle_physics/">控制车辆物理模型</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_control_walker_skeletons/">控制行人骨骼</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_openstreetmap/">使用OpenStreetMap生成地图</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_retrieve_data/">检索模拟数据</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../build_docker_unreal/">在 Docker 中构建虚幻引擎和 Carla</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">教程（资产）</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_A_add_vehicle/">添加新车辆</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_A_add_props/">添加新道具</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_A_create_standalone/">创建独立包</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_A_material_customization/">材料定制</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">教程（开发人员）</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_D_contribute_assets/">如何升级内容</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_D_create_sensor/">创建一个传感器</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_D_create_semantic_tags/">创建语义标签</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_D_customize_vehicle_suspension/">自定义车辆悬架</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_D_generate_colliders/">生成详细碰撞</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_D_make_release/">发布版本</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Carla 生态系统</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../ecosys_ansys/">Ansys 实时雷达模型</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_rllib_integration/">RLlib 集成</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_carsim_integration/">CarSim 集成</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_chrono/">Chrono 集成</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_opendrive/">OpenDRIVE 独立模式</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_ptv/">PTV-Vissim 联合仿真</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_rss/">RSS</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="https://carla.readthedocs.io/projects/ros-bridge/en/latest/">ROS</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">贡献</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../cont_contribution_guidelines/">贡献指南</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cont_code_of_conduct/">行为准则</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cont_coding_standard/">编码标准</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cont_doc_standard/">文档标准</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">驾驶仿真器文档</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">资源</li>
      <li class="breadcrumb-item active">记录器二进制文件格式</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="_1"><a href="https://carla.readthedocs.io/en/latest/ref_recorder_binary_file_format/">记录器二进制文件格式</a></h1>
<p>记录器系统将重放仿真所需的所有信息保存在二进制文件中，对多字节值使用小端字节顺序。</p>
<ul>
<li><a href="#1-strings-in-binary"><strong>1- 二进制字符串</strong></a>  </li>
<li><a href="#2-info-header"><strong>2- 信息头</strong></a>  </li>
<li><a href="#3-packets"><strong>3- 数据包</strong></a>  <ul>
<li><a href="#packet-0-frame-start">数据包 0 - 帧开始</a>  </li>
<li><a href="#packet-1-frame-end">数据包 1 - 帧结束</a>  </li>
<li><a href="#packet-2-event-add">数据包 2 - 事件添加</a>  </li>
<li><a href="#packet-3-event-del">数据包 3 - 事件删除</a>  </li>
<li><a href="#packet-4-event-parent">数据包 4 - 事件父级</a>  </li>
<li><a href="#packet-5-event-collision">数据包 5 - 事件冲突</a>  </li>
<li><a href="#packet-6-position">数据包 6 - 位置</a>  </li>
<li><a href="#packet-7-trafficlight">数据包 7 - 交通灯</a>  </li>
<li><a href="#packet-8-vehicle-animation">数据包 8 - 车辆动画</a>  </li>
<li><a href="#packet-9-walker-animation">数据包 9 - 行人动画</a>  </li>
</ul>
</li>
<li><a href="#4-frame-layout"><strong>4- 帧布局</strong></a>  </li>
<li><a href="#5-file-layout"><strong>5- 文件布局</strong></a>  </li>
</ul>
<p>在下一张代表文件格式的图像中，我们可以快速查看所有详细信息。图像中可视化的每个部分将在以下部分中进行解释：</p>
<p><img alt="file format 1" src="../img/RecorderFileFormat1.jpg" /></p>
<p>总之，该文件格式有一个小头，其中包含一般信息（版本、魔术字符串、日期和使用的地图）和不同类型的数据包集合（目前我们使用 10 种类型，但将来会继续增长） 。</p>
<p><img alt="global file format" src="../img/RecorderFileFormat3.jpg" /></p>
<hr />
<h2 id="1-">1- 二进制字符串</h2>
<p>字符串首先使用其长度进行编码，然后是其字符（不以空字符结尾）。例如，字符串“Town06”将保存为十六进制值：06 00 54 6f 77 6e 30 36</p>
<p><img alt="binary dynamic string" src="../img/RecorderString.jpg" /></p>
<hr />
<h2 id="2-">2- 信息头</h2>
<p>信息标头包含有关录制文件的一般信息。基本上，它包含版本和一个魔术字符串，用于将该文件标识为记录器文件。如果标题发生变化，那么版本也会发生变化。此外，它还包含一个日期时间戳，以及从 1900 年开始的秒数，并且还包含一个字符串，其中包含用于记录的地图名称。</p>
<p><img alt="info header" src="../img/RecorderInfoHeader.jpg" /></p>
<p>示例信息头是：</p>
<p><img alt="info header sample" src="../img/RecorderHeader.jpg" /></p>
<hr />
<h2 id="3-">3- 数据包</h2>
<p>每个数据包以两个字段（5 个字节）的小标头开头：</p>
<p><img alt="packet header" src="../img/RecorderPacketHeader.jpg" /></p>
<ul>
<li><strong>id</strong>: 数据包类型</li>
<li><strong>size</strong>: 数据包数据的大小</li>
</ul>
<p>头信息后面跟着<strong>数据</strong>。数据是可选的，<strong>大小</strong>为 0 表示数据包中没有<strong>数据</strong>。如果<strong>大小</strong>大于 0，则表示数据包有<strong>数据</strong>字节。因此，需要根据数据包的类型重新解释<strong>数据</strong>。</p>
<p>数据包的头很有用，因为我们可以在播放时忽略那些我们不感兴趣的数据包。我们只需要读取数据包的头（前 5 个字节）并跳过数据包的数据跳转到下一个数据包：</p>
<p><img alt="packets size" src="../img/RecorderPackets.jpg" /></p>
<p>数据包的类型有：</p>
<p><img alt="packets type list" src="../img/RecorderPacketsList.jpg" /></p>
<p>我们建议用户自定义数据包使用超过 100 的 <strong>id</strong>，因为这个列表将来会不断增长。</p>
<h3 id="0-">数据包 0 - 帧开始</h3>
<p>该数据包标记新帧的开始，并且它将是开始每个帧的第一个数据包。所有数据包都需要放置在<strong>Frame Start</strong>和<strong>Frame End</strong>之间。</p>
<p><img alt="frame start" src="../img/RecorderFrameStart.jpg" /></p>
<p>因此，经过时间 + 持续时间 = 下一帧经过的时间。</p>
<h3 id="1-_1">数据包 1 - 帧结束</h3>
<p>该帧没有数据，仅标记当前帧的结束。这有助于重放器在新一帧开始之前知道每一帧的结束。通常，下一帧应该是帧起始数据包以开始新帧。</p>
<p><img alt="frame end" src="../img/RecorderFrameEnd.jpg" /></p>
<h3 id="2-_1">数据包 2 - 事件添加</h3>
<p>这个数据包说明了我们需要在当前帧创建多少个参与者。</p>
<p><img alt="event add" src="../img/RecorderEventAdd.jpg" /></p>
<p>字段<strong>总计</strong>表示后面有多少条记录。每条记录都以<strong>id</strong>字段开头，即参与者在录制时所拥有的 id（在播放时，该 id 可以在内部更改，但我们需要使用此 id ）。参与者的<strong>类型</strong>可以有以下可能的值：</p>
<ul>
<li>0 = 其他</li>
<li>1 = 车辆</li>
<li>2 = 行人</li>
<li>3 = 交通灯</li>
<li>4 = 无效</li>
</ul>
<p>之后，继续我们想要创建参与者的<strong>位置</strong>和<strong>旋转</strong>。</p>
<p>在我们得到参与者的描述之后。描述 <strong>uid</strong> 是描述的数字 ID，而 <strong>id</strong> 是文本 ID，例如"vehicle.seat.leon"。</p>
<p>然后是其<strong>属性</strong>的集合，例如颜色、轮子数量、角色等。属性的数量是可变的，应该类似于以下内容：</p>
<ul>
<li>number_of_wheels = 4</li>
<li>sticky_control = true</li>
<li>color = 79,33,85</li>
<li>role_name = autopilot</li>
</ul>
<h3 id="3-_1">数据包 3 - 事件删除</h3>
<p>这个数据包说明了这一帧需要销毁多少个参与者。</p>
<p><img alt="event del" src="../img/RecorderEventDel.jpg" /></p>
<p>它有记录<strong>总数</strong>，每条记录都有要删除的参与者的ID 。</p>
<p>例如，这个数据包可能是这样的：</p>
<p><img alt="event del" src="../img/RecorderPacketSampleEventDel.jpg" /></p>
<p>数字 3 将数据包标识为事件删除。数字 16 是数据包数据的大小（4 个字段，每个字段 4 字节）。因此，如果我们不想处理这个数据包，我们可以跳过接下来的 16 个字节，直接进入下一个数据包的开头。接下来的 3 表示后面的总记录，每条记录都是要删除的参与者的 id。因此，我们需要在这一帧中删除参与者 100、101 和 120。</p>
<h3 id="4-">数据包 4 - 事件父级</h3>
<p>该数据包说明哪个参与者是另一个参与者（父母）的孩子。</p>
<p><img alt="event parent" src="../img/RecorderEventParent.jpg" /></p>
<p>The first id is the child actor, and the second one will be the parent actor.</p>
<h3 id="5-event-collision">数据包 5 - Event Collision</h3>
<p>If a collision happens between two actors, it will be registered in this packet. Currently only
actors with a collision sensor will report collisions, so currently only hero vehicles have that
sensor attached automatically.</p>
<p><img alt="event collision" src="../img/RecorderCollision.jpg" /></p>
<p>The <strong>id</strong> is just a sequence to identify each collision internally.
Several collisions between the same pair of actors can happen in the same frame, because physics
frame rate is fixed and usually there are several physics substeps in the same rendered frame.</p>
<h3 id="6-position">数据包 6 - Position</h3>
<p>This packet records the position and orientation of all actors of type <strong>vehicle</strong> and
<strong>walker</strong> that exist in the scene.</p>
<p><img alt="position" src="../img/RecorderPosition.jpg" /></p>
<h3 id="7-trafficlight">数据包 7 - TrafficLight</h3>
<p>This packet records the state of all <strong>traffic lights</strong> in the scene. Which means that it
stores the state (red, orange or green) and the time it is waiting to change to a new state.</p>
<p><img alt="state" src="../img/RecorderTrafficLight.png" /></p>
<h3 id="8-vehicle-animation">数据包 8 - Vehicle animation</h3>
<p>This packet records the animation of the vehicles, bikes and cycles. This packet stores the
<strong>throttle</strong>, <strong>sterring</strong>, <strong>brake</strong>, <strong>handbrake</strong> and <strong>gear</strong> inputs, and then set them at playback.</p>
<p><img alt="state" src="../img/RecorderVehicle.jpg" /></p>
<h3 id="9-walker-animation">数据包 9 - Walker animation</h3>
<p>This packet records the animation of the walker. It just saves the <strong>speed</strong> of the walker
that is used in the animation.</p>
<p><img alt="state" src="../img/RecorderWalker.jpg" /></p>
<hr />
<h2 id="4-frame-layout">4- Frame Layout</h2>
<p>A frame consists of several packets, where all of them are optional, except the ones that
have the <strong>start</strong> and <strong>end</strong> in that frame, that must be there always.</p>
<p><img alt="layout" src="../img/RecorderFrameLayout.jpg" /></p>
<p><strong>Event</strong> packets exist only in the frame where they happen.</p>
<p><strong>Position</strong> and <strong>traffic light</strong> packets should exist in all frames, because they are
required to move all actors and set the traffic lights to its state.
They are optional but if they are not present then the replayer will not be able to move
or set the state of traffic lights.</p>
<p>The <strong>animation</strong> packets are also optional, but by default they are recorded. That way the walkers
are animated and also the vehicle wheels follow the direction of the vehicles.</p>
<hr />
<h2 id="5-file-layout">5- File Layout</h2>
<p>The layout of the file starts with the <strong>info header</strong> and then follows a collection of packets in
groups. The first in each group is the <strong>Frame Start</strong> packet, and the last in the group is
the <strong>Frame End</strong> packet. In between, we can find the rest of packets as well.</p>
<p><img alt="layout" src="../img/RecorderLayout.jpg" /></p>
<p>Usually, it is a good idea to have all packets regarding events first, and then the packets
regarding position and state later.</p>
<p>The event packets are optional, since they appear when they happen, so we could have a layout
like this one:</p>
<p><img alt="layout" src="../img/RecorderLayoutSample.jpg" /></p>
<p>In <strong>frame 1</strong> some actors are created and reparented, so we can observe its events in the image.
In <strong>frame 2</strong> there are no events. In <strong>frame 3</strong> some actors have collided so the collision event
appears with that info. In <strong>frame 4</strong> the actors are destroyed.</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../catalogue/" class="btn btn-neutral float-left" title="Carla 目录"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../ref_sensors/" class="btn btn-neutral float-right" title="传感器参考">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../catalogue/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../ref_sensors/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../extra.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
