<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>基础 - 代理模拟器</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../extra.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "\u57fa\u7840";
        var mkdocs_page_input_path = "foundations.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> 代理模拟器
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">简介</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../start_introduction/">介绍</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../start_quickstart/">快速启动</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_first_steps/">第一步</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tutorials/">教程</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_E_gallery/">示例</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ecosys_iss/">智能驾驶</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">主题</span></p>
              <ul class="current">
                  <li class="toctree-l1 current"><a class="reference internal current" href="./">基础</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#_2">世界和客户端 </a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#_3">客户端 </a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#_4">世界 </a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#_5">参与者和蓝图 </a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#_6">地图和导航 </a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#_7">传感器和数据 </a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#_8">同步模式和异步模式 </a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#_9">设置同步模式 </a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#_10">使用同步模式 </a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#_11">记录器 </a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#_12">记录 </a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#_13">模拟回放 </a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#_14">记录器文件格式 </a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#_15">渲染 </a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#_16">史诗模式 </a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#_17">低质量模式 </a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#_18">进阶步骤 </a>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../core_world/">第一、 世界和客户端</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../core_actors/">第二、 参与者和蓝图</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../core_map/">第三、地图和导航</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../core_sensors/">第四、 传感器和数据</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../development_tutorials/">开发</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../custom_assets_tutorials/">自定义资产</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_content_authoring_maps/">内容创作-地图</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_content_authoring_vehicles/">内容创作-车辆</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">主题</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../ts_traffic_simulation_overview/">交通模拟概述</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_traffic_manager/">交通管理器</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_sumo/">和 SUMO 协同模拟</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_scenic/">Scenic</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">主题</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_pedestrian_navigation/">行人导航</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_control_walker_skeletons/">控制行人骨架</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_pedestrian_visual/">行人视觉</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_generate_pedestrian_navigation/">生成行人导航</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_content_authoring_pedestrians/">行人建模</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../pedestrian/tuto_content_chrono_opensim/">行人物理场模拟</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">主题</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_opendrive/">OpenDRIVE 独立模式</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_recorder/">记录器</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_rendering_options/">渲染选项</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_rss/">责任敏感安全</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_synchrony_timestep/">同步和时间步长</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_agents/">Carla 代理</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../carla_settings/">Carla 配置</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../simulator_keyboard_input/">Carla 模拟器键盘输入</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../carla_headless/">无显示屏运行 Carla 并选择 GPU</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../epic_automotive_materials/">链接 Epic 的汽车材质</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">自定义地图</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_custom_map_overview/">Carla 中自定义地图的概述</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_generate_map/">在 RoadRunner 中创建地图</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_add_map_package/">在 Carla 包导入地图</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_add_map_source/">在 Carla 源构建中导入地图</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_add_map_alternative/">导入地图的替代方法</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_manual_map_package/">手动准备地图包</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_custom_layers/">自定义地图：分层地图</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_custom_add_tl/">自定义地图：交通灯和标志</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_custom_road_painter/">自定义地图：道路画家</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_custom_weather_landscape/">自定义地图：天气和景观</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_openstreetmap/">使用 OpenStreetMap 生成地图</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_custom_buildings/">自定义地图：程序建筑</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_procedural_building_tool/">程序化建筑工具</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_digital_twin/">数字孪生工具</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../large_map_overview/">大地图概述</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../large_map_roadrunner/">在 RoadRunner 中创建大地图</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../large_map_import/">导入/打包大地图</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">自定义开发</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_add_friction_triggers/">添加摩擦触发器</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_control_vehicle_physics/">控制车辆物理模型</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_retrieve_data/">检索模拟数据</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../build_docker_unreal/">在 Docker 中构建虚幻引擎和 Carla</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_A_add_vehicle/">添加新车辆</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_A_add_props/">添加新道具</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_A_create_standalone/">创建独立包</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_A_material_customization/">材料定制</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_D_contribute_assets/">如何升级内容</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_D_create_sensor/">创建一个传感器</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_D_create_semantic_tags/">创建语义标签</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_D_customize_vehicle_suspension/">自定义车辆悬架</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_D_generate_colliders/">生成详细碰撞</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ue/ue_faq/">虚幻引擎常见问题</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_D_make_release/">发布版本</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">基准测试</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../leaderboard/">自动驾驶排行榜</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../benchmark_start/">驾驶基准</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_benchmarking/">基准性能</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../benchmark_structure/">驾驶基准结构</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../benchmark_creating/">测试代理</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../benchmark_metrics/">计算的基准性能指标</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">生态系统</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../scenario_runner/">交通场景</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../plugins_carlaviz/">Web 可视化器</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ros_documentation/">ROS</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_carsim_integration/">CarSim 集成</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_rllib_integration/">RLlib 集成</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_chrono/">Chrono 集成</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../OpenRadioss/use_OpenRadioss_windows/">OpenRadios 有限元模拟</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_ptv/">PTV-Vissim 联合模拟</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ecosys_ansys/">Ansys 实时雷达模型</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="https://github.com/darkscyla/MATLAB-Carla-Interface">Matlab 接口</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_G29_windows/">罗技 G29 方向盘</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_esmini/">OpenSCENARIO 播放器</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ecosys_femfx/">有限元变形材料虚幻插件</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_cesium/">地理空间生态系统</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../used_by/">应用Carla的仓库列表</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">源代码编译</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../build_carla/">编译 Carla</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../build_linux/">Linux 上编译</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../build_windows/">Windows 上编译</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../build_update/">Carla 更新</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../build_system/">构建系统</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../build_docker/">Docker 中的 Carla</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../build_faq/">常见问题</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_D_windows_debug/">调试程序</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">其他</span></p>
              <ul>
                  <li class="toctree-l1"><a class="" href="https://ww2.mathworks.cn/help/roadrunner/index.html)">RoadRunner</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="https://ww2.mathworks.cn/help/roadrunner-scenario/index.html">RoadRunner Scenario</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../third/">Carla 相关的第三方链接</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_unreal/">虚幻引擎</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="https://docs.blender.org/manual/zh-hans/latest/">Blender 手册</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../file_specification/">文件说明</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../todo/">待做列表</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">参考</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../python_api/">Python API 参考</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ref_cpp/">C++ 参考</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../catalogue/">资源目录</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ref_sensors/">传感器</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../bp_library/">蓝图库</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ref_recorder_binary_file_format/">记录器二进制文件格式</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../measurements/">测量和数据包</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ext_docs/">扩展文档</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">代理模拟器</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">主题</li>
      <li class="breadcrumb-item active">基础</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/OpenHUTB/carla_doc/edit/master/docs/foundations.md" class="icon icon-github"> Edit on GitHub</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="_1"><a href="https://carla.readthedocs.io/en/latest/foundations/">基础</a></h1>
<p>本页介绍了 Carla 服务器和客户端如何通过 API 进行操作和通信所需的基本概念。Carla 使用服务器-客户端架构运行，其中 Carla 服务器运行模拟并由客户端向其发送指令。客户端代码使用 <a href="../python_api/"><strong>API</strong></a> 与服务器进行通信。要使用 Python API，您必须通过 <code>pip</code> 安装该模块：</p>
<pre><code class="language-sh">pip install carla-simulator # Python 2
pip3 install carla-simulator # Python 3
</code></pre>
<p>还要确保在 python 脚本中导入 Carla 包：</p>
<pre><code class="language-py">import carla
</code></pre>
<ul>
<li><a href="#world-and-client"><strong>世界和客户端</strong></a>  <ul>
<li><a href="#client">客户端</a> </li>
<li><a href="#world">世界</a></li>
</ul>
</li>
<li><a href="#actor_blueprint"><strong>参与者和蓝图</strong></a></li>
<li><a href="#map_navigation"><strong>地图和导航</strong></a></li>
<li><a href="#sensor_data"><strong>传感器和数据</strong></a></li>
<li><a href="#synchronous-and-asynchronous-mode"><strong>同步模式和异步模式</strong></a>  <ul>
<li><a href="#setting-synchronous-mode">设置同步模式</a> </li>
<li><a href="#using-synchronous-mode">使用同步模式</a></li>
</ul>
</li>
<li><a href="#recorder"><strong>记录器</strong></a>  <ul>
<li><a href="#recording">记录</a> </li>
<li><a href="#simulation-playback">模拟回放</a></li>
<li><a href="#recorder-file-format">记录器文件格式</a></li>
</ul>
</li>
<li><a href="#rendering"><strong>渲染</strong></a><ul>
<li><a href="#epic_mode">史诗模式</a></li>
<li><a href="#low_quality">低质量模式</a></li>
</ul>
</li>
<li><a href="#advanced_step"><strong>进阶步骤</strong></a></li>
</ul>
<hr />
<h2 id="_2">世界和客户端 <span id="world-and-client"></span></h2>
<h3 id="_3">客户端 <span id="client"></span></h3>
<p><strong>客户端</strong> 是用户运行以请求模拟中的信息或更改的模块。客户端使用 IP 和特定端口运行。它通过终端与服务器通信。可以有许多客户端同时运行。高级多客户端管理需要对 Carla 和 <a href="../adv_synchrony_timestep/">同步</a> 有透彻的了解。</p>
<p>使用 Carla 客户端对象设置客户端：</p>
<pre><code class="language-py">client = carla.Client('localhost', 2000)
</code></pre>
<p>这会将客户端设置为与本地计算机上 <code>localhost</code> 运行的 Carla 服务器进行通信。或者，如果在单独的计算机上运行客户端，则可以使用网络计算机的 IP 地址。第二个参数是端口号。默认情况下，Carla 服务器将在端口 2000 上运行，如有必要，您可以在启动 Carla 时在设置中更改此设置。</p>
<p>客户端对象可用于多种功能，包括加载新地图、记录模拟和初始化交通管理器：</p>
<pre><code class="language-py">client.load_world('Town07')

client.start_recorder('recording.log')
</code></pre>
<h3 id="_4">世界 <span id="world"></span></h3>
<p><strong>世界</strong> 是代表模拟的对象。它充当一个抽象层，包含生成参与者、改变天气、获取世界当前状态等的主要方法。每个模拟只有一个世界。当地图改变时，它会被销毁并替换为新的。</p>
<p>使用客户端对象检索世界对象：</p>
<pre><code class="language-py">world = client.get_world()
</code></pre>
<p>世界对象可用于使用其多种方法访问模拟中的对象，例如天气、车辆、交通灯、建筑物和地图：</p>
<pre><code class="language-py">level = world.get_map()

weather = world.get_weather()

blueprint_library = world.get_blueprint_library()
</code></pre>
<h2 id="_5">参与者和蓝图 <span id="actor_blueprint"></span></h2>
<p>参与者是在模拟中扮演参与者的任何东西。</p>
<ul>
<li>车辆</li>
<li>行人</li>
<li>传感器</li>
<li>观察者</li>
<li>交通信号和交通灯</li>
</ul>
<p><strong>蓝图</strong> 是生成参与者所必需的已经制作好的参与者布局。基本上，是带有动画和一组属性的模型。其中一些属性可以由用户自定义，而另一些则不能。有一个<strong><a href="../bp_library/">蓝图库</a></strong>，其中包含所有可用的蓝图以及有关它们的信息。</p>
<h2 id="_6">地图和导航 <span id="map_navigation"></span></h2>
<p><strong>地图</strong> 是代表模拟世界的对象，主要是城镇。有八张地图可供选择。它们都使用 opdrive 1.4 标准来描述道路。</p>
<p><strong>道路、车道和路口</strong> 由 Python API 管理，以便从客户端访问。这些与 <strong>waypoint</strong> 类一起使用，为车辆提供导航路径。</p>
<p><strong>交通标志</strong> 和 <strong>交通灯</strong> 是可访问的<a href="#python_api.md#carla.landmark"><strong>carla.Landmark</strong></a>。这些地标对象包含关于它们的 OpenDRIVE 定义的信息。此外，模拟器在运行时会自动生成停车标志、让行标志和交通信号灯对象，使用 OpenDRIVE 文件中的信息。这些对象会放置在道路上，有边界框包围。一旦车辆进入它们的边界框，它们就会意识到这些对象。</p>
<h2 id="_7">传感器和数据 <span id="sensor_data"></span></h2>
<p><strong>传感器</strong> 等待一些事件发生，然后从模拟中收集数据。它们调用定义如何管理数据的函数。根据不同的情况，传感器会检索不同类型的传感器数据。</p>
<p>传感器是附着在父车辆上的参与者。它跟随车辆，收集周围环境的信息。可用的传感器由<strong><a href="../bp_library/">Blueprint库</a></strong>中的蓝图定义。</p>
<ul>
<li>相机（RGB，深度和语义分割）</li>
<li>碰撞检测器</li>
<li>全球导航卫星系统传感器</li>
<li>惯性测量单元传感器</li>
<li>激光雷达射线投射</li>
<li>压线检测器</li>
<li>障碍检测器</li>
<li>雷达</li>
<li>责任敏感安全</li>
</ul>
<h2 id="_8">同步模式和异步模式 <span id="synchronous-and-asynchronous-mode"></span></h2>
<p>Carla 具有客户端-服务器架构。服务器运行模拟。客户端检索信息并请求模拟中的更改。本节涉及客户端和服务器之间的通信。</p>
<p>默认情况下，Carla 以 <strong>异步模式</strong> 运行。</p>
<p>本质上，在 <strong>异步模式</strong> 下，Carla 服务器会尽可能快地运行。客户请求是即时处理的。在 <strong>同步模式</strong> 下，运行 Python 代码的客户端负责控制并告诉服务器何时更新。</p>
<p>如果您正在实验或设置模拟，<strong>异步模式</strong> 是运行 Carla 的合适模式，因此您可以在放置参与者时与观察者一起在地图上飞行。当您想要开始生成训练数据或在模拟中部署代理时，建议您使用 <strong>同步模式</strong> ，因为这将为您提供更多的控制力和可预测性。</p>
<p>阅读有关 <a href="../adv_synchrony_timestep/"><strong>同步模式和异步模式</strong></a> 的更多信息。</p>
<div class="admonition 笔记">
<p class="admonition-title">笔记</p>
<p>在多客户端架构中，只有一个客户端应该发出节拍。服务器对收到的每个节拍做出响应，就好像它来自同一客户端一样。许多客户端的节拍将使服务器和客户端之间产生不一致。</p>
</div>
<h3 id="_9">设置同步模式 <span id="setting-synchronous-mode"></span></h3>
<p>同步模式和异步模式之间的更改只是布尔状态的问题。</p>
<pre><code class="language-py">settings = world.get_settings()
settings.synchronous_mode = True # 启用同步模式
settings.fixed_delta_seconds = 0.05
world.apply_settings(settings)
</code></pre>
<div class="admonition 警告">
<p class="admonition-title">警告</p>
<p>如果启用了同步模式，并且正在运行交通管理器，则也必须将其设置为同步模式。阅读 <a href="../adv_traffic_manager/#synchronous-mode">本文</a> 以了解如何操作。</p>
</div>
<p>要禁用同步模式，只需将变量设置为 <code>False</code> 或使用脚本<code>PythonAPI/util/config.py</code>。</p>
<pre><code class="language-sh">cd PythonAPI/util &amp;&amp; python3 config.py --no-sync # 禁用同步模式
</code></pre>
<p>同步模式无法使用脚本启用，只能禁用。启用同步模式使服务器等待客户端节拍。使用此脚本，用户无法在需要时发送节拍。 </p>
<h3 id="_10">使用同步模式 <span id="using-synchronous-mode"></span></h3>
<p>同步模式与缓慢的客户端应用程序以及需要不同元素（例如传感器）之间的同步时特别相关。如果客户端太慢而服务器没有等待，就会出现信息溢出。客户将无法管理一切，并且会丢失或混合。同样，对于许多传感器和异步情况，不可能知道所有传感器是否都在模拟中使用同一时刻的数据。</p>
<p>以下代码片段扩展了前一个代码片段。客户端创建一个摄像头传感器，将当前步骤的图像数据存储在队列中，并从队列中检索后发送节拍给服务器。可以在 <a href="https://github.com/carla-simulator/carla/blob/master/PythonAPI/examples/synchronous_mode.py">此处</a> 找到有关多个传感器的更复杂的示例。</p>
<pre><code class="language-py">settings = world.get_settings()
settings.synchronous_mode = True
world.apply_settings(settings)

camera = world.spawn_actor(blueprint, transform)
image_queue = queue.Queue()
camera.listen(image_queue.put)

while True:
    world.tick()
    image = image_queue.get()
</code></pre>
<div class="admonition 重要">
<p class="admonition-title">重要</p>
<p>来自基于 GPU 传感器（主要是摄像头）的数据通常会延迟几帧生成。同步在这里至关重要。</p>
</div>
<p>世界上有异步方法可以让客户端等待服务器节拍，或者在收到服务器节拍时执行某些操作。</p>
<pre><code class="language-py"># 等待下一个节拍并获取节拍的快照
world_snapshot = world.wait_for_tick()

# 注册一个回调，以便在每次收到新的快照时都被调用。
world.on_tick(lambda world_snapshot: do_something(world_snapshot))
</code></pre>
<h2 id="_11">记录器 <span id="recorder"></span></h2>
<p>记录器可以将重现先前模拟所需的所有数据保存到文件中。这些数据包括车辆的位置和速度、交通信号灯的状态、行人的位置和速度以及太阳的位置和天气状况等详细信息。数据被记录到一个二进制文件中，Carla 服务器稍后可以加载该文件以准确地再现模拟。</p>
<p>参与者根据记录文件中包含的数据在每一帧上进行更新。当前模拟中出现在记录中的参与者将被移动或重新生成以模拟它。那些没有出现在记录中的人会继续他们的路，就像什么都没发生一样。</p>
<div class="admonition 重要">
<p class="admonition-title">重要</p>
<p>播放结束时，车辆将设置为自动驾驶，但 <strong>行人不会停下来</strong> 。</p>
</div>
<p>记录器文件包括有关许多不同元素的信息。</p>
<ul>
<li><strong>参与者</strong> — 创造和销毁、边界和触发盒。</li>
<li><strong>交通等</strong> — 状态变化和时间设置。</li>
<li><strong>车辆</strong> — 位置和方向、线速度和角速度、光状态和物理控制。</li>
<li><strong>行人</strong> — 位置和方向，以及线速度和角速度。</li>
<li><strong>灯光</strong> — 建筑物、街道和车辆的灯光状态。</li>
</ul>
<h3 id="_12">记录 <span id="recording"></span></h3>
<p>要开始记录，只需要一个文件名。在文件名中使用<code>\</code>,<code>/</code>或<code>:</code>字符会将其定义为绝对路径。如果没有详细路径，文件将保存在<code>CarlaUE4/Saved</code>。</p>
<pre><code class="language-py">client.start_recorder(&quot;/home/carla/recording01.log&quot;)
</code></pre>
<p>默认情况下，记录器设置为仅存储回放模拟所需的信息。为了保存前面提到的所有信息，<code>additional_data</code>必须在开始记录时配置参数。</p>
<pre><code class="language-py">client.start_recorder(&quot;/home/carla/recording01.log&quot;, True)
</code></pre>
<div class="admonition 笔记">
<p class="admonition-title">笔记</p>
<p>其他数据包括：车辆和行人的线速度和角速度、交通灯时间设置、执行时间、参与者的触发器和边界框以及车辆的物理控制。</p>
</div>
<p>要停止记录，调用也很简单。</p>
<pre><code class="language-py">client.stop_recorder()
</code></pre>
<div class="admonition 笔记">
<p class="admonition-title">笔记</p>
<p>据估计，50 个交通灯和 100 辆车的 1 小时记录大约需要 200MB 大小。</p>
</div>
<h3 id="_13">模拟回放 <span id="simulation-playback"></span></h3>
<p>可以在模拟过程中的任何时刻开始播放。除了日志文件的路径之外，此方法还需要一些参数。</p>
<pre><code class="language-py">client.replay_file(&quot;recording01.log&quot;, start, duration, camera)
</code></pre>
<table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
<th>笔记</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>start</code></td>
<td>记录开始模拟的时间（以秒为单位）。</td>
<td>如果为正，时间将从记录开始算起。 <br> 如果为负，则从最后考虑。</td>
</tr>
<tr>
<td><code>duration</code></td>
<td>播放秒数。0 为全部记录。</td>
<td>播放结束时，车辆将设置为自动驾驶，行人将停止。</td>
</tr>
<tr>
<td><code>camera</code></td>
<td>相机将聚焦的参与者的 ID。</td>
<td>将其设置<code>0</code>是让观察者自由移动。</td>
</tr>
</tbody>
</table>
<p><br></p>
<h3 id="_14">记录器文件格式 <span id="recorder-file-format"></span></h3>
<p>记录器以 <a href="../ref_recorder_binary_file_format/"><strong>本文档</strong></a> 中指定的自定义二进制文件格式保存所有数据。</p>
<hr />
<h2 id="_15">渲染 <span id="rendering"></span></h2>
<p>Carla 提供了许多有关渲染质量和效率的选项。在最基本的层面上，Carla 提供了两种质量选项，可以在高规格和低规格硬件上运行并获得最佳效果：</p>
<h3 id="_16">史诗模式 <span id="epic_mode"></span></h3>
<p><code>./CarlaUE4.sh -quality-level=Epic</code></p>
<p><img alt="Epic mode screenshot" src="../img/rendering_quality_epic.jpg" />
<em>史诗模式截图</em></p>
<h3 id="_17">低质量模式 <span id="low_quality"></span></h3>
<p><code>./CarlaUE4.sh -quality-level=Low</code></p>
<p><img alt="Low mode screenshot" src="../img/rendering_quality_low.jpg" />
<em>低质量模式截图</em></p>
<p>Carla 还提供暂停渲染或离屏渲染的选项，以便更有效地记录或运行模拟。</p>
<p>有关渲染选项的更多详细信息，请参见 <a href="../adv_rendering_options/"><strong>此处</strong></a>。</p>
<h2 id="_18">进阶步骤 <span id="advanced_step"></span></h2>
<p>Carla 提供了广泛的功能，超出了本模拟器介绍的范围。这里列出了一些最引人注目的。然而，在开始 <strong>进阶步骤</strong> 之前，强烈建议阅读整个“基础”部分。</p>
<ul>
<li><strong><a href="../adv_opendrive/">OpenDRIVE独立模式</a></strong>。仅使用 OpenDRIVE 文件生成道路网格。允许在 Carla 中加载任何 OpenDRIVE 地图，无需创建资源。</li>
<li><strong><a href="../adv_ptv/">PTV-Vissim协同模拟</a></strong>。在 Carla 和 PTV-Vissim 交通模拟器之间运行协同模拟。</li>
<li><a href="../adv_recorder/"><strong>记录器</strong></a>。保存模拟状态的快照，以便以精确的精度重新执行模拟。</li>
<li><strong><a href="../adv_rendering_options/">渲染选项</a></strong>。包括图形质量设置、离屏渲染和无渲染模式。</li>
<li><a href="../adv_rss/"><strong>责任敏感安全</strong></a>（Responsibility Sensitive Safety）：集成用于根据安全检查修改车辆轨迹的责任敏感安全性<strong><a href="https://github.com/intel/ad-rss-lib">C++库</a> </strong>。</li>
<li><a href="../adv_synchrony_timestep/"><strong>模拟时间和同步</strong></a>。关于模拟时间和服务器-客户端通信的所有内容。</li>
<li><strong><a href="../adv_sumo/">SUMO协同模拟</a></strong>：在 Carla 和 SUMO 交通模拟器之间运行协同模拟。</li>
<li><strong><a href="../adv_traffic_manager/">交通管理器</a></strong>：该模块负责所有设置为自动驾驶模式的车辆。它模拟城市中的交通，使模拟看起来像一个真实的城市环境。</li>
</ul>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../ecosys_iss/" class="btn btn-neutral float-left" title="智能驾驶"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../core_world/" class="btn btn-neutral float-right" title="第一、 世界和客户端">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/OpenHUTB/carla_doc" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
      <span><a href="../ecosys_iss/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../core_world/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../extra.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
