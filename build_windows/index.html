<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Windows 上编译 - 交通仿真文档</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../extra.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Windows \u4e0a\u7f16\u8bd1";
        var mkdocs_page_input_path = "build_windows.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> 交通仿真文档
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">主页</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">入门</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../start_introduction/">介绍</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../start_quickstart/">快速启动包安装</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_first_steps/">第一步</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tutorials/">教程</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">构建 Carla</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../build_carla/">构建 Carla</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../build_linux/">Linux 上编译</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">Windows 上编译</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#_1">第一部分：先决条件</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#_2">系统要求</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#_3">软件要求</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#carla">第二部分：构建 Carla</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#carla_1">克隆 Carla 存储库</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#_7">获取资产</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#_8">设置虚幻引擎变量</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#carla_2">构建 Carla</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#_9">其他构建命令</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#_10">附加：构建步骤分析</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#updatebat">Update.bat</a>
    </li>
        </ul>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../build_update/">Carla 更新</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../build_system/">编译系统</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../build_docker/">Docker 中的 Carla</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../build_faq/">常问的问题</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Carla 主题</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../foundations/">概念和基础</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../core_world/">第一、世界和客户端</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../core_actors/">第二、参与者和蓝图</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../core_map/">第三、地图和导航 </a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../core_sensors/">第四、传感器和数据</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../development_tutorials/">开发</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../custom_assets_tutorials/">自定义资产</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_content_authoring_maps/">内容创作 - 地图</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_content_authoring_vehicles/">内容创作 - 车辆</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">交通仿真</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../ts_traffic_simulation_overview/">交通</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_traffic_manager/">交通管理器</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_sumo/">和 SUMO 联合仿真</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_scenic/">Scenic</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">行人</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_pedestrian_bones/">行人骨骼</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_control_walker_skeletons/">控制行人骨骼</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_pedestrian_visual/">行人视觉</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_generate_pedestrian_navigation/">生成行人导航</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">高级概念</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_opendrive/">OpenDRIVE 独立模式</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_recorder/">记录器</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_rendering_options/">渲染选项</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_rss/">责任敏感安全</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_synchrony_timestep/">同步和时间步长</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_benchmarking/">基准性能</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_agents/">Carla 智能体</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">资源</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../python_api/">Python API 参考</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ref_cpp/">C++ 参考</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../bp_library/">蓝图库</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../catalogue/">Carla 目录</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ref_recorder_binary_file_format/">记录器二进制文件格式</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ref_sensors/">传感器参考</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ext_docs/">扩展文档</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">自定义地图</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_custom_map_overview/">Carla 中自定义地图的概述</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_generate_map/">在 RoadRunner 中创建地图</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_add_map_package/">在 Carla 包导入地图</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_add_map_source/">在 Carla 源构建中导入地图</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_add_map_alternative/">导入地图的替代方法</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_manual_map_package/">手动准备地图包</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_custom_layers/">自定义地图：分层地图</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_custom_add_tl/">自定义地图：红绿灯和标志</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_custom_road_painter/">自定义地图：道路画家</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_custom_weather_landscape/">自定义地图：天气和景观</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_openstreetmap/">使用 OpenStreetMap 生成地图</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_custom_buildings/">自定义地图：程序建筑</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_digital_twin/">数字孪生工具</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">大地图</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../large_map_overview/">大地图概述</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../large_map_roadrunner/">在RoadRunner中创建大地图</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../large_map_import/">导入/打包大地图</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">教程（通用）</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_add_friction_triggers/">添加摩擦触发器</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_control_vehicle_physics/">控制车辆物理模型</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_retrieve_data/">检索仿真数据</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../build_docker_unreal/">在 Docker 中构建虚幻引擎和 Carla</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">教程（资产）</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_A_add_vehicle/">添加新车辆</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_A_add_props/">添加新道具</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_A_create_standalone/">创建独立包</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_A_material_customization/">材质定制</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">教程（开发人员）</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_D_contribute_assets/">如何升级内容</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_D_create_sensor/">创建一个传感器</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_D_create_semantic_tags/">创建语义标签</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_D_customize_vehicle_suspension/">自定义车辆悬架</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_D_generate_colliders/">生成详细碰撞</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_D_make_release/">发布版本</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_D_windows_debug/">调试程序</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">示例</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_E_gallery/">入门</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_traffic_light/">交通灯的配置和使用</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_traffic_prediction/">流量预测</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Carla 生态系统</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../ecosys_iss/">ISS 智能驾驶系统</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../plugins_carlaviz/">Web 可视化器</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ros_documentation/">ROS</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ecosys_femfx/">有限元变形材料虚幻插件</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_carsim_integration/">CarSim 集成</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_rllib_integration/">RLlib 集成</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_chrono/">Chrono 集成</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../OpenRadioss/use_OpenRadioss_windows/">OpenRadios 有限元仿真</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_ptv/">PTV-Vissim 联合仿真</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ecosys_ansys/">Ansys 实时雷达模型</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="https://github.com/darkscyla/MATLAB-Carla-Interface">Matlab 接口</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_G29_windows/">罗技 G29 方向盘</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">贡献</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../cont_contribution_guidelines/">贡献指南</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cont_code_of_conduct/">行为准则</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cont_coding_standard/">编码标准</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cont_doc_standard/">文档标准</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">其他</span></p>
              <ul>
                  <li class="toctree-l1"><a class="" href="https://ww2.mathworks.cn/help/roadrunner/index.html">RoadRunner</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="https://ww2.mathworks.cn/help/roadrunner-scenario/index.html">RoadRunner Scenario</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="https://bbs.carla.org.cn/">Carla 中文站</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="https://github.com/OpenHUTB/engine_doc">虚幻引擎教程</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="https://docs.blender.org/manual/zh-hans/latest/">Blender 手册</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../todo/">待做列表</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">交通仿真文档</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">构建 Carla</li>
      <li class="breadcrumb-item active">Windows 上编译</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="windows">Windows 下的构建</h1>
<p>本指南详细介绍了如何在 Windows 上从源代码构建 Carla。有两个部分。第一部分详细介绍系统要求和所需软件的安装，第二部分详细介绍如何实际构建和运行 Carla。</p>
<p>构建过程很长（4小时或更长时间）并且涉及多种软件。强烈建议在开始之前完整阅读该指南。</p>
<p>如果您遇到错误或困难，请查看<strong><a href="../build_faq/">常见问题解答</a></strong>页面，其中提供了最常见问题的解决方案。或者使用 <a href="https://github.com/carla-simulator/carla/discussions">Carla 论坛</a> 发布您可能有的任何疑问。</p>
<ul>
<li><a href="#part-one-prerequisites"><strong>第一部分：先决条件</strong></a><ul>
<li><a href="#system-requirements">系统要求</a></li>
<li><a href="#software-requirements">软件要求</a><ul>
<li><a href="#minor-installations">基础软件安装</a></li>
<li><a href="#python-dependencies">Python 依赖项</a></li>
<li><a href="#major-installations">主要软件安装</a><ul>
<li><a href="#visual-studio-2019">Visual Studio 2019</a></li>
<li><a href="#unreal-engine">虚幻引擎</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#part-two-build-carla"><strong>第二部分：构建 Carla</strong></a><ul>
<li><a href="#clone-the-carla-repository">克隆 Carla 仓库</a></li>
<li><a href="#get-assets">获取资产</a></li>
<li><a href="#set-unreal-engine-environment-variable">设置虚幻引擎环境变量</a></li>
<li><a href="#build-carla">构建 Carla</a></li>
<li><a href="#other-make-commands">其他 make 命令</a></li>
</ul>
</li>
</ul>
<hr />
<h2 id="_1">第一部分：先决条件</h2>
<p>在本节中，您将找到开始构建 Carla 之前所需的系统要求、次要和主要软件安装以及 Python 依赖项的详细信息。</p>
<h3 id="_2">系统要求</h3>
<ul>
<li><strong>64 位操作系统。</strong> 仿真器应在任何 64 位 Windows 系统中运行。 </li>
<li><strong>165 GB 磁盘空间。</strong> Carla 本身将占用大约 32 GB，相关的主要软件安装（包括虚幻引擎）将占用大约 133 GB。</li>
<li><strong>足够的 GPU。</strong> Carla 旨在实现真实仿真，因此服务器至少需要 6 GB GPU，但建议使用 8 GB。强烈建议使用专用 GPU 进行机器学习。</li>
<li><strong>两个 TCP 端口和良好的互联网连接。</strong> 默认端口为 2000 和 2001 。 确保这些端口未被防火墙或任何其他应用程序阻止。 </li>
</ul>
<div class="admonition 笔记">
<p class="admonition-title">笔记</p>
<p><strong>如果您要从 Carla 0.9.12 升级到 0.9.13</strong>: 您必须首先将虚幻引擎 4 的 Carla 分支升级到最新版本。有关升级虚幻引擎 4 的详细信息，请参阅 <a href="#unreal-engine"><strong>虚幻引擎</strong></a> 部分。</p>
</div>
<h3 id="_3">软件要求</h3>
<h4 id="_4">基础软件安装</h4>
<ul>
<li><a href="https://cmake.org/download/"><strong>CMake</strong></a> 从简单的配置文件生成标准构建文件。  </li>
<li><a href="https://git-scm.com/downloads"><strong>Git</strong></a> 是一个用于管理 Carla 存储库的版本控制系统。</li>
<li><a href="http://gnuwin32.sourceforge.net/packages/make.htm"><strong>Make</strong></a> 生成可执行文件。必须使用 <strong>Make 的 3.81 版本</strong>，否则构建可能会失败。如果安装了多个版本的 Make，请检查构建 Carla 时在 PATH 中使用的版本是否为 3.81。您可以通过运行来检查默认的 Make 版本 <code>make --version</code>。</li>
<li><a href="https://www.7-zip.org/"><strong>7Zip</strong></a> 一款文件压缩软件。这是自动解压缩资产文件所必需的，并防止在构建期间由于错误或部分提取大文件而出现错误。</li>
<li><a href="https://www.python.org/downloads/"><strong>Python3 x64</strong></a> 是 Carla 中的主要脚本语言。安装 x32 版本可能会导致冲突，因此强烈建议卸载它。</li>
</ul>
<div class="admonition 重要">
<p class="admonition-title">重要</p>
<p>确保将上述程序添加到 <a href="https://www.java.com/en/download/help/path.xml">环境路径</a> 中。请记住，添加的路径应与程序的 <code>bin</code> 目录相对应。</p>
</div>
<h4 id="python">Python 依赖项</h4>
<p>从 Carla 0.9.12 开始，用于可以选择使用 <code>pip3</code> 来安装 Carla 的 Python API。要检查您是否有合适的版本，请运行以下命令：</p>
<pre><code class="language-sh">pip3 -V
</code></pre>
<p>如果您需要升级：</p>
<pre><code class="language-sh">pip3 install --upgrade pip
</code></pre>
<p>您必须安装以下 Python 依赖项：</p>
<pre><code class="language-sh">pip3 install --user setuptools
pip3 install --user wheel
</code></pre>
<h4 id="_5">主要软件安装</h4>
<h5 id="visual-studio-2019">Visual Studio 2019</h5>
<p>从 <a href="https://developerinsider.co/download-visual-studio-2019-web-installer-iso-community-professional-enterprise/">此处</a> 获取 2019 版 Visual Studio 。选择 <strong>社区</strong> 作为免费版本。使用 <strong>Visual Studio 安装程序</strong> 安装三个附加元素： </p>
<ul>
<li><strong>Windows 8.1 SDK.</strong> 在右侧的 <em>Installation details</em> 部分中选择它，或者转到 <em>Indivdual Components</em> 选项卡并在 <em>SDKs, libraries, and frameworks</em> 标题下查看。</li>
<li><strong>x64 Visual C++ Toolset.</strong> 在 <em>Workloads</em> 部分中，选择 <strong>Desktop development with C++</strong> 。这将启用用于构建的 x64 命令提示符。通过按 <code>Windows</code> 按钮并搜索 <code>x64</code> 来检查它是否已正确安装。小心 <strong>不要打开<code>x86_x64</code>提示</strong>。</li>
<li><strong>.NET framework 4.6.2</strong>. 在 <em>Workloads</em> 部分中，选择 <strong>.NET desktop development</strong> ，然后在右侧的安装详细信息面板中选择 <code>.NET Framework 4.6.2 development tools</code>。这是构建虚幻引擎所必需的。</li>
</ul>
<div class="admonition 重要">
<p class="admonition-title">重要</p>
<p>其他 Visual Studio 版本可能会导致冲突。即使这些已被卸载，某些寄存器也可能仍然存在。要从计算机中彻底清除 Visual Studio，请转到<code>Program Files (x86)\Microsoft Visual Studio\Installer\resources\app\layout</code>并运行 <code>.\InstallCleanup.exe -full</code>。</p>
</div>
<p><a href="https://learn.microsoft.com/zh-cn/visualstudio/install/use-command-line-parameters-to-install-visual-studio?view=vs-2019">命令行参数安装</a> 。</p>
<div class="admonition 笔记">
<p class="admonition-title">笔记</p>
<p>还可以通过上述步骤使用 Visual Studio 2022，并将 Windows 8.1 SDK 替换为 Windows 11/10 SDK。要覆盖 CMake 中的默认 Visual Studio 2019 Generator，请在使用 makefile 命令时指定 GENERATOR="Visual Studio 17 2022"（请参见 <a href="https://carla.readthedocs.io/en/latest/build_windows/#other-make-commands">表</a> ）。您可以指定任何与构建脚本中特定的构建命令配合使用的生成器，以进行完整列表运行<code>cmake -G</code>（到目前为止，Ninja 已经过测试可用于构建 LibCarla）。</p>
</div>
<h5 id="_6">虚幻引擎</h5>
<p>从版本 0.9.12 开始，Carla 使用虚幻引擎 4.26 的修改版。该分支包含 Carla 特定的补丁。</p>
<p>请注意，要下载虚幻引擎的这个分支，<strong>您需要有一个链接到虚幻引擎帐户的 GitHub 帐户</strong> 。如果您没有进行此设置，请先按照 <a href="https://www.unrealengine.com/en-US/ue4-on-github">本指南</a> 进行操作，然后再继续操作。</p>
<p>要构建虚幻引擎的修改版本：</p>
<p><strong>1.</strong> 在终端中，导航到要保存虚幻引擎的位置并克隆 <em>carla</em> 分支：</p>
<pre><code class="language-sh">git clone --depth 1 -b carla https://github.com/CarlaUnreal/UnrealEngine.git .
</code></pre>
<div class="admonition 笔记">
<p class="admonition-title">笔记</p>
<p>虚幻引擎文件夹尽可能靠近<code>C:\\</code>，因为如果路径超过一定长度，<code>Setup.bat</code>则会在步骤 3 中返回错误。</p>
</div>
<p><strong>2.</strong> 运行配置脚本：</p>
<pre><code class="language-sh">Setup.bat
GenerateProjectFiles.bat
</code></pre>
<p><strong>3.</strong> 编译修改后的引擎：</p>
<blockquote>
<ol>
<li>
<p>使用 Visual Studio 2019打开<code>UE4.sln</code>源文件夹内的文件。</p>
</li>
<li>
<p>在构建栏中，确保您已选择“Development Editor”、“Win64”和“UnrealBuildTool”选项。如果您需要任何帮助，请查看 <a href="https://docs.unrealengine.com/en-US/ProductionPipelines/DevelopmentSetup/BuildingUnrealEngine/index.html">本指南</a> 。</p>
</li>
<li>
<p>在解决方案资源管理器中，右键单击<code>UE4</code>并选择<code>Build</code>。</p>
</li>
</ol>
</blockquote>
<p><strong>4.</strong> 编译解决方案后，您可以打开引擎，通过启动可执行文件 <code>Engine\Binaries\Win64\UE4Editor.exe</code> 来检查所有内容是否已正确安装。</p>
<div class="admonition 笔记">
<p class="admonition-title">笔记</p>
<p>如果安装成功，虚幻引擎的版本选择器应该能够识别。您可以通过右键单击任何<code>.uproject</code>文件并选择 <code>Switch Unreal Engine version</code> 来检查这一点。您应该会看到一个弹出窗口，显示<code>Source Build at PATH</code>是您选择的安装路径。如果您在右键单击<code>.uproject</code>文件或<code>Generate Visual Studio project files</code>时看不到此选择器，则虚幻引擎安装出现问题，您可能需要重新正确安装。</p>
</div>
<div class="admonition 重要">
<p class="admonition-title">重要</p>
<p>到目前为止发生了很多事情。强烈建议在继续之前重新启动计算机。</p>
</div>
<hr />
<h2 id="carla">第二部分：构建 Carla</h2>
<h3 id="carla_1">克隆 Carla 存储库</h3>
<div class="build-buttons">
<p>
<a href="https://github.com/carla-simulator/carla" target="_blank" class="btn btn-neutral" title="Go to the CARLA repository">
<span class="icon icon-github"></span> Carla 仓库</a>
</p>
</div>

<p>上面的按钮将带您进入该项目的官方存储库。从那里下载并在本地提取它或使用以下命令克隆它：</p>
<pre><code class="language-sh">git clone https://github.com/carla-simulator/carla
</code></pre>
<div class="admonition 笔记">
<p class="admonition-title">笔记</p>
<p>该<code>master</code>分支包含 Carla 的当前版本以及最新的修复和功能。以前的 Carla 版本标有版本名称。永远记住使用命令<code>git branch</code>检查 git 中的当前分支。</p>
</div>
<h3 id="_7">获取资产</h3>
<p>通过在 Carla 根文件夹中运行以下命令，下载 <strong>最新的</strong> 资产以使用当前版本的 Carla：</p>
<pre><code class="language-sh">Update.bat
</code></pre>
<p>如果安装了 7zip，资源将被下载并解压到适当的位置。如果您没有安装此软件，则需要手动将文件内容解压到<code>Unreal\CarlaUE4\Content\Carla</code>。</p>
<p>要下载 <strong>特定版本</strong> Carla 的资源：</p>
<ol>
<li>从 Carla 根目录，导航到<code>\Util\ContentVersions.txt</code>。本文档包含所有 Carla 版本的资产链接。</li>
<li>提取 <code>Unreal\CarlaUE4\Content\Carla</code> 中的资产。如果该路径不存在，请创建它。</li>
<li>使用类似于以下内容的命令提取文件：</li>
</ol>
<pre><code class="language-sh">tar -xvzf &lt;assets_file_name&gt;.tar.gz.tar -C C:\path\to\carla\Unreal\CarlaUE4\Content\Carla
</code></pre>
<h3 id="_8">设置虚幻引擎变量</h3>
<p>需要设置一个环境变量，以便 Carla 可以找到虚幻引擎的安装文件夹。这允许用户选择要使用哪个特定版本的虚幻引擎。如果未指定环境变量，Carla 将在 Windows 注册表中搜索虚幻引擎并使用在那里找到的第一个版本。</p>
<p>设置环境变量：</p>
<ol>
<li>打开 Windows 控制面板，然后转至<code>Advanced System Settings</code>或在 Windows 搜索栏中搜索  <code>Advanced System Settings</code>。</li>
<li>在面板上Advanced<code>Advanced</code>打开<code>Environment Variables...</code>。</li>
<li>单击<code>New...</code>以创建变量。</li>
<li>为变量<code>UE4_ROOT</code>命名并选择所需虚幻引擎安装的安装文件夹的路径。</li>
</ol>
<h3 id="carla_2">构建 Carla</h3>
<p>本节概述了构建 Carla 的命令。</p>
<ul>
<li>所有命令都应在根 Carla 文件夹中运行。</li>
<li>命令应通过VS 2019 的 <strong>x64 Native Tools Command Prompt for VS 2019</strong> 执行。通过单击该Windows键并搜索 来打开它x64。</li>
</ul>
<p>Carla 的构建过程分为两部分：编译客户端和编译服务器。</p>
<p><strong>1.</strong> <strong>编译 Python API 客户端</strong>:</p>
<p>Python API 客户端授予对仿真的控制权。第一次构建 Carla 时需要编译 Python API 客户端，并且在执行任何更新后需要再次编译。客户端编译完成后，您将能够运行脚本与仿真进行交互。</p>
<p>以下命令编译 Python API 客户端：</p>
<pre><code class="language-sh">    make PythonAPI
</code></pre>
<p>Carla 客户端库将以两种截然不同、互斥的形式构建。这使用户可以自由选择他们喜欢的形式来运行 Carla 客户端代码。两种形式包括<code>.egg</code>文件和<code>.whl</code>文件。选择以下选项 <strong>之一</strong> 来使用客户端库：</p>
<p><strong>A. <code>.egg</code> 文件</strong></p>
<blockquote>
<p><code>.egg</code> 文件不需要安装。导入 Carla 时，Carla 的所有示例脚本都会自动 <a href="../build_system/#versions-prior-to-0912">查找此文件</a> 。</p>
<p>如果您之前安装了 CARLA <code>.whl</code>，则 它将<code>.whl</code>优先于<code>.egg</code>文件。 </p>
</blockquote>
<p><strong>B. <code>.whl</code> 文件</strong></p>
<blockquote>
<p>应使用以下<code>pip3</code>命令安装<code>.whl</code>文件：</p>
</blockquote>
<pre><code class="language-sh">pip3 install &lt;path/to/wheel&gt;.whl
</code></pre>
<blockquote>
<p><code>.whl</code>文件无法分发，因为它是专门为您的操作系统构建的。</p>
</blockquote>
<div class="admonition 警告">
<p class="admonition-title">警告</p>
<p>使用不同方法安装 Carla 客户端库以及系统上安装不同版本的 Carla 可能会出现问题。建议在安装 <code>.whl</code> 时使用虚拟环境，并在安装新客户端库之前 <a href="../build_faq/#how-do-i-uninstall-the-carla-client-library">卸载</a> 任何以前安装的客户端库。</p>
</div>
<p><strong>2.</strong> <strong>编译服务端</strong>:</p>
<p>以下命令编译并启动虚幻引擎。每次您想要启动服务器或使用虚幻引擎编辑器时运行此命令：</p>
<pre><code class="language-sh">make launch
</code></pre>
<p>该项目可能会要求构建其他实例，例如<code>UE4Editor-Carla.dll</code>第一次。同意才能打开项目。在首次启动期间，编辑器可能会显示有关着色器和网格距离场的警告。这些需要一些时间来加载，在此之前地图将无法正确显示。</p>
<div class="admonition 笔记">
<p class="admonition-title">笔记</p>
<p>如果编译过程中出现中文乱码，为了便于寻找编译错误，可以使用<code>chcp 65001</code>命令将编码方式修改为UTF-8（选择“属性”。在“属性”&gt;&gt;“选项”一栏中，就可以看到当前代码页的编码方式）。</p>
</div>
<p><strong>3.</strong> <strong>开始仿真</strong>:</p>
<p>按<strong>Play</strong>开始服务器仿真。可以使用按键移动相机<code>WASD</code>，并通过在移动鼠标的同时单击场景来旋转相机。 </p>
<p>使用里面的示例脚本测试仿真器<code>PythonAPI\examples</code>。在仿真器运行的情况下，为每个脚本打开一个新终端并运行以下命令以在城镇中产生一些生命并创建天气循环：</p>
<pre><code class="language-sh">        # 终端 A 
        cd PythonAPI\examples
        pip3 install -r requirements.txt
        python3 generate_traffic.py  

        # 终端 B
        cd PythonAPI\examples
        python3 dynamic_weather.py 
</code></pre>
<div class="admonition 重要">
<p class="admonition-title">重要</p>
<p>如果仿真以非常低的 FPS 速率运行，请转至虚幻引擎编辑器<code>Edit -&gt; Editor preferences -&gt; Performance</code>并禁用。</p>
</div>
<h3 id="_9">其他构建命令</h3>
<p>您可能会发现还有更多有用的<code>make</code>命令。在下表中找到它们：</p>
<table>
<thead>
<tr>
<th>命令</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>make help</code></td>
<td>打印所有可用的命令。</td>
</tr>
<tr>
<td><code>make launch</code></td>
<td>在编辑器窗口中启动 Carla 服务器。</td>
</tr>
<tr>
<td><code>make PythonAPI</code></td>
<td>构建 Carla 客户端。</td>
</tr>
<tr>
<td><code>make LibCarla</code></td>
<td>准备将 Carla 库导入到任何地方。</td>
</tr>
<tr>
<td><code>make package</code></td>
<td>构建 Carla 并创建用于分发的打包版本。</td>
</tr>
<tr>
<td><code>make clean</code></td>
<td>删除构建系统生成的所有二进制文件和临时文件。</td>
</tr>
<tr>
<td><code>make rebuild</code></td>
<td><code>make clean</code> 和 <code>make launch</code> 两者都在一个命令中。</td>
</tr>
</tbody>
</table>
<h2 id="_10">附加：构建步骤分析</h2>
<h3 id="updatebat">Update.bat</h3>
<ol>
<li>环境变量初始化；</li>
<li>获取最新的资产包；</li>
<li>
<p>下载并解压资产内容；</p>
<p>如果不存在7zip就用<code>powershell -Command "Expand-Archive '</code>命令进行解压。</p>
</li>
</ol>
<h4 id="makefile">Makefile</h4>
<ol>
<li>
<p><code>make PythonAPI</code></p>
<p>执行<code>Util/BuildTools/BuildPythonAPI.bat</code>，真正执行的是<code>python setup.py bdist_egg bdist_wheel</code>，在<code>PythonAPI/carla/dist</code>目录下生成<code>*.egg</code>和<code>*.whl</code>文件；</p>
</li>
<li>
<p><code>make launch</code></p>
<p>执行<code>Util/BuildTools/Windows.mk</code>，真正执行的是<code>BuildLibCarla.bat</code>，构建LibCarla的服务端和客户端；</p>
</li>
</ol>
<hr />
<p>有关本指南的任何问题， 请阅读 <strong><a href="../build_faq/">常见问题解答</a></strong> 页面或在 <a href="https://github.com/carla-simulator/carla/discussions">Carla 论坛</a> 中发帖。</p>
<p>现在您已经构建了 Carla，接下来了解如何更新 Carla 构建或在仿真中迈出第一步，并学习一些核心概念。</p>
<div class="build-buttons">

<p>
<a href="../build_update" target="_blank" class="btn btn-neutral" title="Learn how to update the build">
更新 Carla</a>
</p>

<p>
<a href="../core_concepts" target="_blank" class="btn btn-neutral" title="Learn about CARLA core concepts">
第一步</a>
</p>

</div>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../build_linux/" class="btn btn-neutral float-left" title="Linux 上编译"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../build_update/" class="btn btn-neutral float-right" title="Carla 更新">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../build_linux/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../build_update/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../extra.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
