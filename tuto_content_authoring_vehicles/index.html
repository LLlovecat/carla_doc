<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>内容创作 - 车辆 - 驾驶仿真器文档</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../extra.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "\u5185\u5bb9\u521b\u4f5c - \u8f66\u8f86";
        var mkdocs_page_input_path = "tuto_content_authoring_vehicles.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> 驾驶仿真器文档
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">主页</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">入门</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../start_introduction/">介绍</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../start_quickstart/">快速启动包安装</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_first_steps/">第一步</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">构建 Carla</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../build_carla/">构建 Carla</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../build_linux/">Linux 构建</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../build_windows/">Windows 构建</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../build_update/">更新 Carla</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../build_system/">构建系统</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../build_docker/">Docker 中的 Carla</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../build_faq/">常问的问题</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">下一步</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_content_authoring_maps/">内容创作 - 地图</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="./">内容创作 - 车辆</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#modeling">Modeling</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#naming-conventions">Naming conventions</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#rigging-the-vehicle-using-an-armature">Rigging the vehicle using an armature</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#import">Import</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#add-an-armature">Add an armature</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#parenting">Parenting</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#assigning-car-parts-to-bones">Assigning car parts to bones</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#blender-ue4-vehicle-rigging-add-on">Blender UE4 vehicle rigging add-on</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#export">Export</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#importing-into-unreal-engine">Importing into unreal engine</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#setting-the-physics-asset">Setting the physics asset</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#creating-the-animation">Creating the animation</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#creating-the-blueprint">Creating the blueprint</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#materials">Materials</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#applying-a-material-to-your-vehicle">Applying a material to your vehicle</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#color">Color</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#clear-coat">Clear coat</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#orange-peel">Orange peel</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#flakes">Flakes</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#dust">Dust</a>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#glass">Glass</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#glass-meshes">Glass meshes</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#glass-material">Glass material</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#single-layer-glass">Single layer glass</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#wheels">Wheels</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#wheel-blueprint">Wheel blueprint</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#collision-mesh">Collision mesh</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#tire-configuration">Tire configuration</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#wheel-dimensions">Wheel dimensions</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#suspension-characteristics">Suspension characteristics</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#lights">Lights</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#uv-map">UV map</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#importing">Importing</a>
    </li>
        </ul>
    </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Carla 主题</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../foundations/">基础</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../core_concepts/">核心概念</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../core_world/">世界和客户端</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../core_actors/">参与者和蓝图</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../core_map/">地图和导航 </a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../core_sensors/">传感器和数据</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ts_traffic_simulation_overview/">交通</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../development_tutorials/">开发</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../custom_assets_tutorials/">自定义资产</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">高级概念</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_recorder/">记录器</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_rendering_options/">渲染选项</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_synchrony_timestep/">同步和时间步长</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_benchmarking/">基准性能</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_agents/">Carla 智能体</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">交通仿真</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_traffic_manager/">交通管理器</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_sumo/">SUMO 联合仿真</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_scenic/">Scenic</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">资源</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../python_api/">Python API 参考</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ref_cpp/">C++ 参考</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../bp_library/">蓝图库</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../catalogue/">Carla 目录</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ref_recorder_binary_file_format/">记录器二进制文件格式</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ref_sensors/">传感器参考</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tutorials/">教程</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ext_docs/">扩展文档</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">插件</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../plugins_carlaviz/">carlaviz — web 可视化器</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">ROS 桥接器</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../ros_documentation/">ROS 桥文档</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">自定义地图</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_custom_map_overview/">Carla 中自定义地图的概述</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_generate_map/">在 RoadRunner 中创建地图</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_add_map_package/">在CARLA包导入地图</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_add_map_source/">在 Carla 源构建中导入地图</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_add_map_alternative/">导入地图的替代方法</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_manual_map_package/">手动准备地图包</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_custom_layers/">自定义地图：分层地图: Layered maps</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_custom_add_tl/">自定义地图：红绿灯和标志</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_custom_road_painter/">自定义地图：Road painter</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_custom_buildings/">自定义地图：程序建筑</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_custom_weather_landscape/">自定义地图：天气和景观</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_generate_pedestrian_navigation/">生成行人导航</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">大型地图</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../large_map_overview/">大型地图概述</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../large_map_roadrunner/">在RoadRunner中创建大地图</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../large_map_import/">导入/打包大地图</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">教程（通用）</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_add_friction_triggers/">添加摩擦触发器</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_control_vehicle_physics/">控制车辆物理模型</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_control_walker_skeletons/">控制行人骨骼</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_openstreetmap/">使用OpenStreetMap生成地图</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_retrieve_data/">检索模拟数据</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../build_docker_unreal/">在 Docker 中构建虚幻引擎和 Carla</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">教程（资产）</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_A_add_vehicle/">添加新车辆</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_A_add_props/">添加新道具</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_A_create_standalone/">创建独立包</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_A_material_customization/">材料定制</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">教程（开发人员）</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_D_contribute_assets/">如何升级内容</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_D_create_sensor/">创建一个传感器</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_D_create_semantic_tags/">创建语义标签</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_D_customize_vehicle_suspension/">自定义车辆悬架</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_D_generate_colliders/">生成详细碰撞</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_D_make_release/">发布版本</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Carla 生态系统</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../ecosys_ansys/">Ansys 实时雷达模型</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_rllib_integration/">RLlib 集成</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_carsim_integration/">CarSim 集成</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_chrono/">Chrono 集成</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_opendrive/">OpenDRIVE 独立模式</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_ptv/">PTV-Vissim 联合仿真</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_rss/">RSS</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="https://carla.readthedocs.io/projects/ros-bridge/en/latest/">ROS</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">贡献</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../cont_contribution_guidelines/">贡献指南</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cont_code_of_conduct/">行为准则</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cont_coding_standard/">编码标准</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cont_doc_standard/">文档标准</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">驾驶仿真器文档</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">下一步</li>
      <li class="breadcrumb-item active">内容创作 - 车辆</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="content-authoring-vehicles">Content authoring - vehicles</h1>
<p>CARLA provides a comprehensive set of vehicles out of the box in the blueprint library. CARLA allows the user to expand upon this with custom vehicles for maximum extensibility. </p>
<p>3D modelling of detailed vehicles is highly complex and requires a significant degree of skill. We therefore refer the reader to alternative sources of documentation on 3D modelling, since this is beyond the scope of this guide. There are, however, numerous sources of vehicle models in both free and proprietary online repositories. Hence the user has many options to turn to for creating custom vehicles for use in CARLA.</p>
<p>The key factors in preparing a custom vehicle for CARLA lie in rigging the vehicle armature and then importing into the Unreal Engine. After rigging and importing, blueprints need to be set for the car and the wheels. Then apply materials and add the glass parts of the vehicle. We will cover these steps in the following guide.</p>
<ul>
<li><strong><a href="#modeling">Modeling</a></strong>   <ul>
<li><a href="#naming-conventions">Naming conventions</a>  </li>
</ul>
</li>
<li><strong><a href="#rigging-the-vehicle-using-an-armature">Rigging</a></strong>   <ul>
<li><a href="#import">Import</a>  </li>
<li><a href="#add-an-armature">Armature</a></li>
<li><a href="#parenting">Parenting</a></li>
<li><a href="#assigning-car-parts-to-bones">Assignment</a> </li>
<li><a href="#blender-ue4-vehicle-rigging-add-on">Blender add-on</a></li>
<li><a href="#export">Export</a>  </li>
</ul>
</li>
<li><strong><a href="#importing-into-unreal-engine">Import into Unreal Engine</a></strong>   <ul>
<li><a href="#setting-the-physics-asset">Physics asset</a>  </li>
<li><a href="#creating-the-animation">Animation</a></li>
<li><a href="#creating-the-blueprint">Blueprint</a></li>
</ul>
</li>
<li><strong><a href="#materials">Materials</a></strong>   <ul>
<li><a href="#applying-a-material-to-your-vehicle">Applying materials</a><ul>
<li><a href="#color">Color</a></li>
<li><a href="#clear-coat">Clear coat</a></li>
<li><a href="#orange-peel">Orange peel</a></li>
<li><a href="#flakes">Flakes</a></li>
<li><a href="#dust">Dust</a></li>
</ul>
</li>
</ul>
</li>
<li><strong><a href="#glass">Glass</a></strong>   <ul>
<li><a href="#glass-meshes">Glass meshes</a></li>
<li><a href="#glass-material">Glass material</a></li>
<li><a href="#single-layer-glass">Single layer glass</a></li>
</ul>
</li>
<li><strong><a href="#wheels">Wheels</a></strong>   <ul>
<li><a href="#wheel-blueprint">Wheel blueprint</a></li>
<li><a href="#collision-mesh">Collision mesh</a></li>
<li><a href="#tire-configuration">Tire configuration</a></li>
<li><a href="#wheel-dimensions">Wheel dimensions</a></li>
</ul>
</li>
<li><strong><a href="#lights">Lights</a></strong><ul>
<li><a href="#uv-map">UV map</a></li>
<li><a href="#importing">Importing</a></li>
</ul>
</li>
</ul>
<h2 id="modeling">Modeling</h2>
<p>Vehicles should have between 50,000 and 100,000 faces. We recommend triangulating the model prior to export as best practice. CARLA vehicles are modeled using the size and scale of actual cars as reference. Please ensure you pay careful attention to the units of your 3D application. Some work in centimeters while others work in meters. </p>
<h3 id="naming-conventions">Naming conventions</h3>
<p>For ease and consistency we recommend that you divide the vehicle into the following parts and name them accordingly. Details specific to glass and lights will be covered in later sections:</p>
<blockquote>
<ol>
<li><strong>Bodywork</strong>: The metallic part of the vehicle. This material is changed to Unreal Engine material. Logos and details can be added but, to be visible, they must be painted in a different color by using the alpha channels in the Unreal Engine editor.</li>
<li><strong>Glass_Ext</strong>: A layer of glass that allows visibility from the outside to the inside of the vehicle.</li>
<li><strong>Glass_Int</strong>: A layer of glass that allows visibility from the inside to the outside of the vehicle.</li>
<li><strong>Lights</strong>: Headlights, indicator lights, etc.</li>
<li><strong>LightGlass_Ext</strong>: A layer of glass that allows visibility from the outside to the inside of the light.</li>
<li><strong>LightGlass_Int</strong>: A layer of glass that allows visibility from the inside to the outside of the light.</li>
<li><strong>LicensePlate</strong>: A rectangular plane of 29x12 cm. You can use the CARLA provided <code>.fbx</code> for best results, download it <a href="https://carla-assets.s3.eu-west-3.amazonaws.com/fbx/LicensePlate.rar">here</a>. The texture will be assigned automatically in Unreal Engine.</li>
<li><strong>Interior</strong>: Any other details that don't fit in the above sections can go into <em>Interior</em>.</li>
</ol>
</blockquote>
<p>Materials should be named using the format <code>M_CarPart_CarName</code>, e.g, <code>M_Bodywork_Mustang</code>.</p>
<p>Textures should be named using the format <code>T_CarPart_CarName</code>, e.g, <code>T_Bodywork_Mustang</code>. Textures should be sized as 2048x2048.</p>
<h2 id="rigging-the-vehicle-using-an-armature">Rigging the vehicle using an armature</h2>
<p>To look realistic within the simulation, the car needs to have rotating and wheels, the front pair of which can turn with steering inputs. Therefore to prepare a vehicle for CARLA, an armature needs to be rigged to the car to identify the wheels and allow their movement. </p>
<h3 id="import">Import</h3>
<p>Import or model the vehicle model mesh in your 3D modelling application. In this guide we will use Blender 3D. Ensure that the wheels are separable from the main body. Each wheel must be accessible as a distinct object. </p>
<p><img alt="model_in_blender" src="../img/tuto_content_authoring_vehicles/import_model_blender.png" /></p>
<p>It is important to ensure that the vehicle faces in the positive X direction, so the hood and windshield should be facing towards positive X. The car should also be oriented such that the floor to roof direction is in the positive Z direction. The wheels should be just grazing the X-Y plane and the origin should be situated where you would expect the vehicle's center of mass to be in the X-Y plane (not in the Z plane though).</p>
<h3 id="add-an-armature">Add an armature</h3>
<p>Now add an armature to the center of the vehicle, ensure the object is properly centered, the root of the armature bone should be set at the origin. Switch to edit mode and rotate the armature 90 around the x axis. </p>
<p><img alt="armature_init" src="../img/tuto_content_authoring_vehicles/vehicle_base_bone.png" /></p>
<p>Now select the armature and add 4 more bones. Each of these bones needs to be located such that the root of the bone coincides with the centre of the each wheel. This can be achieved by locating the 3D cursor at the center of each wheel in edit mode. Select one of the wheels in object mode, select a vertex, press A to select all vertices then <code>Shift+S</code> and select <code>Cursor to selected</code>. This will locate the cursor in the center of the wheel. Then, in object mode, select the armature, switch to edit mode, select a bone and choose <code>Selection to cursor</code>. Your bone will now coincide with the wheel. Rotate each bone such that it lines up with the base of the armature. </p>
<p>For each wheel, it is recommended to name the bone according to the wheel it needs to be coupled to, this will help in identification later when you need to assign vertex groups to each bone. </p>
<p><img alt="armature_full" src="../img/tuto_content_authoring_vehicles/all_vehicle_bones.png" /></p>
<h3 id="parenting">Parenting</h3>
<p>Now select all the parts of the body and all 4 wheels using shift or control in the project outliner,  then control select the armature you have created (this order is important, it won't work if you select these in reverse order). Press <code>Ctrl+p</code> and select <code>With empty groups</code> to bind the mesh to the armature.  </p>
<p><img alt="bind_armature" src="../img/tuto_content_authoring_vehicles/bind_armature.gif" /></p>
<p>Now you have parented the mesh to the armature, you now need to assign each wheel to its respective bone. Select a wheel either in the outliner or the editor. Switch to edit mode, and select all the vertices of the wheel (shortcut - <code>a</code>). </p>
<h3 id="assigning-car-parts-to-bones">Assigning car parts to bones</h3>
<p>Select the mesh tab of the properties (the green triangle). Inside the vertex groups tab of the mesh properties panel, you should now see the bones of your armature. Select the bone corresponding to the wheel you are editing and select <code>Assign</code>. Once you have rigged the wheels, rig all other parts of the vehicle to the base bone.</p>
<p><img alt="assign_bone" src="../img/tuto_content_authoring_vehicles/assign_vertex_group.gif" /></p>
<p>Once you have assigned all of the mesh parts to the armature you can test if it works by selecting the armature and moving to pose mode and moving the relevant bones. The vehicle base bone should move the whole vehicle, while the wheel bones should each move and rotate their respective wheels. Ensure to undo any posing you might do with <code>Ctrl+Z</code>.</p>
<p><img alt="test_armature" src="../img/tuto_content_authoring_vehicles/test_pose.gif" /></p>
<h3 id="blender-ue4-vehicle-rigging-add-on">Blender UE4 vehicle rigging add-on</h3>
<p>There is a very useful add on for blender for rigging a vehicle for import into CARLA that helps streamline the above steps. Please see the <a href="https://continuebreak.com/creations/ue4-vehicle-rigging-addon-blender/"><strong>add-on webpage</strong></a> for instructions.</p>
<h3 id="export">Export</h3>
<p>Now we will export our rigged model into FBX format for import into Unreal Engine. Select <code>Export &gt; FBX (.fbx)</code> from the File menu. In the <code>Object Types</code> section of the <code>Include</code> panel, shift select the <code>Armature</code> and <code>Mesh</code> options. </p>
<p>In the <code>Transform</code> panel. Change <code>Forward</code> to <code>X Forward</code> and change <code>Up</code> to <code>Z Up</code>. This is important to ensure the vehicle is oriented correctly in the Unreal Engine. </p>
<p>In the <code>Armature</code> section uncheck <code>Add Leaf Bones</code> and uncheck <code>Bake Animation</code>.</p>
<p><img alt="export_fbx" src="../img/tuto_content_authoring_vehicles/export_fbx.gif" /></p>
<h2 id="importing-into-unreal-engine">Importing into unreal engine</h2>
<p>Launch the Unreal Editor with the <code>make launch</code> command from the CARLA root directory (the one where you have built CARLA from source). Open a content browser, set up an appropriate directory and right click and select <code>Import to ....</code>. Choose the FBX file that you previously exported from Blender (or another 3D modelling application). Import with default settings. </p>
<h3 id="setting-the-physics-asset">Setting the physics asset</h3>
<p>You will now have 3 things in your content browser directory, the mesh, the skeleton and the physics asset. Double click on the physics asset to adjust it.</p>
<p><img alt="regenerate_body" src="../img/tuto_content_authoring_vehicles/physics_asset.png" /></p>
<p>First, select the main body, in the <code>Details</code> menu on the right, change the <code>Linear Damping</code> to 0.0 in the <code>Physics</code> section, check <code>Simulation Generates Hit Events</code> in the <code>Collision</code> section and change the <code>Primitive Type</code> from <code>Capsule</code> to <code>Box</code> in the <code>Body Creation</code> section. Then press <code>Regenerate bodies</code>. The capsule will now change to a rectangular box. Then select the wheels.</p>
<p><img alt="physics_details" src="../img/tuto_content_authoring_vehicles/physics_details.png" /></p>
<p>Now select all the wheels (in the <code>Skeleton Tree</code> section on the left). </p>
<p><img alt="regenerate_wheels" src="../img/tuto_content_authoring_vehicles/wheels_asset.png" /></p>
<p>Change <code>Linear Damping</code> to 0.0, set <code>Physics Type</code> to <code>Kinematic</code>, set <code>Collision Response</code> to <code>Disabled</code> and select the <code>Primitive Type</code> as <code>Sphere</code>. Press <code>Re-generate Bodies</code> once more.</p>
<p><img alt="regenerate_wheels" src="../img/tuto_content_authoring_vehicles/wheel_physics_details.png" /></p>
<h3 id="creating-the-animation">Creating the animation</h3>
<p>In the content browser directory where you have your new vehicle asset, right click and choose <code>Animation &gt; Animation Blueprint</code>. In the popup that opens, search for <code>VehicleAnimInstance</code> in the <code>Parent Class</code> section and for the <code>Target Skeleton</code> search for the skeleton corresponding to your new vehicle, you should be able to see the name in your content browser. After selecting these two things press OK. This will create a new animation blueprint for your vehicle.</p>
<p><img alt="animation_blueprint" src="../img/tuto_content_authoring_vehicles/create_anim_blueprint.png" /></p>
<p>To simplify things, we can copy the animation from another vehicle. In a second content browser, open <code>Content &gt; Carla &gt; Static &gt; Vehicles &gt; 4Wheeled</code> and choose any vehicle. Open the animation blueprint of your chosen vehicle and then copy all nodes that are not the <code>Output pose</code> node from this into your new animation blueprint. Connect the nodes by dragging a new connection between the final node to the output node. Press compile and the animation blueprint is now set.</p>
<p><img alt="copy_nodes" src="../img/tuto_content_authoring_vehicles/animation_blueprint_setup.gif" /></p>
<h3 id="creating-the-blueprint">Creating the blueprint</h3>
<p>Navigate with your content browser into <code>Content &gt; Carla &gt; Blueprints &gt; Vehicles &gt; LincolnMKZ2017</code> or a similar vehicle. In here you will find a set of blueprints set up for the 4 wheels. Copy these into the directory containing your own vehicle and rename them to ensure you can distinguish them later. You can set up your own custom wheels if you prefer, please refer to the later <a href="#wheels"><strong>wheels section</strong></a></p>
<p><img alt="copy_wheels" src="../img/tuto_content_authoring_vehicles/copy_wheels.png" /></p>
<p>Right click in the content browser directory where your new vehicle assets are and chose <code>Blueprint Class</code>. Search in the <code>All Classes</code> menu for <code>BaseVehiclePawn</code> and choose this class. Name the blueprint and open it. Select <code>Mesh</code> in the <code>Components</code> tab on the left and then drag the vehicle mesh into the Mesh section on the right hand side.</p>
<p><img alt="blueprint_with_mesh" src="../img/tuto_content_authoring_vehicles/blueprint_with_mesh.png" /></p>
<p>In <code>Anim Class</code> search for the animation corresponding to your new vehicle that you set up in the previous step.</p>
<p>Next, select <code>Vehicle Movement</code> in the <code>Components</code> menu of the blueprint class and in the right <code>Details</code> menu navigate to the <code>Vehicle Setup</code> section. Now for each wheel, find the relevant wheel blueprint that you previously copied and renamed for the <code>Wheel Class</code> attribute. Do the same for each wheel. Compile and save.</p>
<p><img alt="wheel_setup" src="../img/tuto_content_authoring_vehicles/vehicle_wheel_setup.gif" /></p>
<p>Now navigate to <code>Content &gt; Carla &gt; Blueprints &gt; Vehicles &gt; VehicleFactory</code> and double click this to open the Vehicle Factory.</p>
<p>Select the <code>Vehicles</code> node and expand the <code>Vehicles</code> item in the <code>Default value</code> section on the right hand side.</p>
<p><img alt="vehicle_factory" src="../img/tuto_content_authoring_vehicles/vehicle_factory_page.png" /></p>
<p>Press the plus icon to add your new vehicle. Scroll down to the last entry and expand it, it should be empty. Name the make and model of your vehicle and under the class section find your blueprint class that you created in the previous section. Leave the number of wheels as 4 and put the generation as 2. Compile and save. Do a global save for safety and you are now..ready to run your vehicle in a simulation. </p>
<p>Press play in the unreal toolbar to run the simulation. Once it is running, open a terminal and run the <code>manual_control.py</code> script with the filter option to specify your new vehicle model:</p>
<pre><code class="language-sh">python manual_control.py --filter my_vehicle_make
</code></pre>
<p><img alt="manual_control" src="../img/tuto_content_authoring_vehicles/manual_control.gif" /></p>
<p>As it is, the vehicle currently has no textures or colors applied. The next step is to apply materials to give your vehicle a finish like a real road vehicle.</p>
<h2 id="materials">Materials</h2>
<p>Once you have your vehicle imported as a basic asset with the mesh and blueprints laid out, you now want to add materials to your vehicle to facilitate photorealistic rendering in the Unreal Engine, for maximum fidelity in your machine learning training data.</p>
<p>The Unreal Editor boasts a comprehensive materials workflow that facilitates the creation of highly realistic materials. This does, however, add a significant degree of complexity to the process. For this reason, CARLA is provided with a large library of material prototypes for you to use without having to start from scratch. </p>
<h3 id="applying-a-material-to-your-vehicle">Applying a material to your vehicle</h3>
<p>CARLA provides a prototype material for replicating the glossy finish of vehicles that can mimic numerous different types of vehicle paint jobs and features. Open Unreal editor and in the content browser, locate the material in <code>Content &gt; Carla &gt; Static &gt; GenericMaterials &gt; 00_MastersOpt</code>. The basic material is called <code>M_CarPaint_Master</code>. Right click on this material and choose <code>Create Material Instance</code> from the context material. Name it and move it into the folder where your new vehicle content is stored.</p>
<p>In the Unreal Editor, move the spectator to a point near the floor and drag the skeletal mesh of the vehicle from the content browser into the scene, the body of your vehicle will now appear there. </p>
<p><img alt="add_model" src="../img/tuto_content_authoring_vehicles/add_model.gif" /></p>
<p>Now, in the details panel on the right hand side, drag your new material instance into the <code>Element 0</code> position of the <code>Materials</code> section. You will see the bodywork take on a new grey, glossy material property.</p>
<p><img alt="apply_material" src="../img/tuto_content_authoring_vehicles/apply_material.gif" /></p>
<p>Double click on the material in the content browser and we can start editing the parameters. There are a numerous parameters here that alter various properties that are important to mimic real world car paint jobs. The most important parameters are the following:</p>
<h4 id="color"><strong>Color</strong></h4>
<p>The color settings govern the overall color of the car. The base color is simply the primary color of the car this will govern the overall color:</p>
<p><img alt="change_base_color" src="../img/tuto_content_authoring_vehicles/change_base_color.gif" /></p>
<h4 id="clear-coat"><strong>Clear coat</strong></h4>
<p>The clear coat settings govern the appearance of the finish and how it reacts to light. The roughness uses a texture to apply imperfections to the vehicle surface, scattering light more with higher values to create a matte look. Subtle adjustments and low values are recommended for a realistic look. Generally, car paint jobs are smooth and reflective, however, this effect might be used more generously to model specialist matte finishes of custom paint jobs.</p>
<p><img alt="change_roughness" src="../img/tuto_content_authoring_vehicles/roughness.gif" /></p>
<p>An important parameter to govern the "shininess" or "glossiness" of your car is the <code>Clear Coat Intensity</code>. High values close to 1 will make the coat shiny and glossy.</p>
<h4 id="orange-peel"><strong>Orange peel</strong></h4>
<p>Finishes on real cars (particularly on mass produced cars for the general market) tend to have imperfections that appear as slight ripples in the paint. The orange peel effect mimics this and makes cars look more realistic.</p>
<p><img alt="change_orange_peel" src="../img/tuto_content_authoring_vehicles/orange_peel.gif" /></p>
<h4 id="flakes"><strong>Flakes</strong></h4>
<p>Some cars have paint jobs that include flakes of other material, such as metals or ceramics, to give the car a <code>metallic</code> or <code>pearlescant</code> appearance, adding extra glints and reflections that react in an attractive way to light. The flakes parameters allows CARLA to mimic this. To mimic metallic finishes, it would be </p>
<p><img alt="flakes" src="../img/tuto_content_authoring_vehicles/flakes.gif" /></p>
<h4 id="dust"><strong>Dust</strong></h4>
<p>Cars often accumulate grease and dust on the body that adds additional texture to the paint, affecting the way it reflects the light. The dust parameters allow you to add patches of disruption to the coat to mimic foreign materials sticking to the paint. </p>
<p><img alt="dust" src="../img/tuto_content_authoring_vehicles/change_dust.gif" /></p>
<h2 id="glass">Glass</h2>
<p>Creating realistic glass in CARLA requires some tricks to capture the real refractive and reflective behavior of glass used in motor vehicles. The CARLA garage vehicles have 4 layers of meshes for the glass, with 2 different materials. The layers are separated by a few millimeters and there are separate materials for the interior and exterior facing glass layers to ensure that the glass looks realistic from both inside and outside the vehicle.</p>
<p>There are 2 layers of glass for the appearance of the vehicle from outside and 2 layers for the appearance of glass from the interior of the vehicle. What makes glass look like glass is the reflections coming from both surfaces of the glass that makes a very subtle doubling of the reflection.</p>
<h3 id="glass-meshes">Glass meshes</h3>
<p>Here we see the glass parts attached to the main bodywork (not the doors or other moving parts) of the Lincoln.</p>
<p><img alt="main_glass" src="../img/tuto_content_authoring_vehicles/glass.png" /></p>
<p>If we separate the constituent mesh parts, we can see that the glass profile is separated into 4 different layers. </p>
<p><img alt="main_glass_expanded" src="../img/tuto_content_authoring_vehicles/glass_expanded.png" /></p>
<p>The 4 layers are separated into 2 groups, the exterior layers, with normals facing out of the vehicle and the interior layers, with mesh normals facing into the vehicle interior. The following diagram demonstrates </p>
<p><img alt="glass_layers" src="../img/tuto_content_authoring_vehicles/glass_layers.png" /></p>
<p>Once you have created your mesh layers, import them in the content browser into the Unreal Editor in the folder where you have stored your vehicle. </p>
<p>Shift select the 4 glass layers and drag them into the map so you can see them.</p>
<p><img alt="drag_glass" src="../img/tuto_content_authoring_vehicles/drag_glass.gif" /></p>
<h3 id="glass-material">Glass material</h3>
<p>Double click the external layer of the glass, then navigate in a second content browser window to <code>Content &gt; Carla &gt; Static &gt; Vehicles &gt; GeneralMaterials</code> and find the <code>Glass</code> material. Drag the glass material to the material slot of the mesh item. Repeat this process for each layer of the glass.</p>
<p>The glass will now be transparent, but with reflectivity that reflects nearby objects and light sources. You should also check the interior glass, ensure there is a proper glass effect there.</p>
<p><img alt="glass_reflections" src="../img/tuto_content_authoring_vehicles/glass_reflections.gif" /></p>
<h3 id="single-layer-glass">Single layer glass</h3>
<p>For a quicker way to produce the glass parts of vehicles, the only critical part is the outermost glass layer. You can apply the glass material to this in Unreal Editor and get a result that might be suitable to your needs, however, views from inside the vehicle (i.e. if you instantiate a camera on the dashboard or behind the steering wheel) will seem to have no glass (no refraction or reflection). We recommend the above process to produce maximally realistic glass.</p>
<p>Now you have created the blueprint, added meshes, completed rigging, created materials for the paint finish and the glass, you should have a very realistic looking vehicle.</p>
<p><img alt="finished_lincoln" src="../img/tuto_content_authoring_vehicles/finished_lincoln.png" /></p>
<h2 id="wheels">Wheels</h2>
<p>If you copied the wheels when you were <a href="#creating-the-blueprint">creating the blueprint</a>, this might suit your purposes if your vehicle is very similar to vehicles that are already in the CARLA library. However, if your vehicle has non-standard wheel dimensions or grip characteristics, you should follow this section to set up your wheel blueprints to best match the physical characteristics of your vehicle's wheels.</p>
<p>For the wheels of CARLA vehicles, we need to set up a blueprint class for each wheel to deal with the mechanics and collision properties. You will set up 4 blueprint classes, we recommend the following prefixes or suffixes to identify the wheels:</p>
<ul>
<li><strong>RRW</strong> - <strong>R</strong>ear <strong>R</strong>ight <strong>W</strong>heel</li>
<li><strong>RLW</strong> - <strong>R</strong>ear <strong>L</strong>eft <strong>W</strong>heel</li>
<li><strong>FRW</strong> - <strong>F</strong>ront <strong>R</strong>ight <strong>W</strong>heel</li>
<li><strong>FLW</strong> - <strong>F</strong>ront <strong>L</strong>eft <strong>W</strong>heel</li>
</ul>
<h3 id="wheel-blueprint">Wheel blueprint</h3>
<p>Inside the folder where you have your new vehicle, right click and choose to create a new blueprint class. Search for </p>
<p><img alt="wheel_blueprint" src="../img/tuto_content_authoring_vehicles/wheel_blueprint.png" /></p>
<p>Double click on the blueprint to adjust it:</p>
<p><img alt="wheel_blueprint_open" src="../img/tuto_content_authoring_vehicles/wheel_bp_open.png" /></p>
<h3 id="collision-mesh">Collision mesh</h3>
<p>Firstly, the default cylinder used for the collision mesh has a high polygon count, so we should replace this with a low polygon version. In the content browser locate the <code>CollisionWheel</code> mesh inside <code>Content &gt; Carla &gt; Blueprints &gt; Vehicles</code>. Drag it onto the 
<code>Collision Mesh</code> slot in the details panel of the blueprint. This will improve performance without any noticeable deficit to physics simulation.</p>
<h3 id="tire-configuration">Tire configuration</h3>
<p>Next, we  set the tire configuration. Inside <code>Content &gt; Carla &gt; Blueprints &gt; Vehicles</code> locate the <code>CommonTireConfig</code> configuration and drag it onto the <code>Tire Config</code> section of the blueprint. If you double click on the Tire Config in the blueprint, you can adjust the Friction Scale, you can modify the behavior of the vehicle's road handling. By default it is set at 3.5, a value suitable for most vehicle use cases. However, if you wish to model for example a racing vehicle with slick tires, this would be the appropriate parameter to adjust. </p>
<h3 id="wheel-dimensions">Wheel dimensions</h3>
<p>Next, in your 3D application, measure the diameter of your wheel. In Blender, the dimensions can be viewed in the properties panel opened by pressing <code>n</code> in object mode.</p>
<p><img alt="tire_dimensions" src="../img/tuto_content_authoring_vehicles/wheel_dims.png" /></p>
<p>Now plug these numbers into the <code>Wheel</code> section of the blueprint.Take care to remember to half the diameter for the radius and also that Unreal Editor works in units of centimeters. For the wheel mass, we recommend looking for specifications on the internet, find the right tire model or a similar one to estimate the correct mass (in kilograms).</p>
<p><img alt="bp_wheel_dimensions" src="../img/tuto_content_authoring_vehicles/bp_wheel_dimensions.png" /></p>
<p><code>Affected by handbrake</code> should be checked for both rear wheels. </p>
<p><code>Steer angle</code> should be set to the maximum intended steer angle for both front wheels and set to zero for both rear wheels.</p>
<h3 id="suspension-characteristics"><strong>Suspension characteristics</strong></h3>
<p>The default values here provide a reasonable starting point. View <a href="../tuto_D_customize_vehicle_suspension/"><strong>this guide</strong></a> to set suspension characteristics appropriate to your vehicle type. </p>
<h2 id="lights">Lights</h2>
<p>The last element to complete a realistic vehicle for CARLA is the lights, headlights, brake lights, blinkers etc. In your 3D modelling application, you should model some shapes that resemble the lights of the vehicle you are replicating. This would be flat discs or flat cuboid structures for most headlights. Some vehicles may also have strips of LEDs. </p>
<p><img alt="lights_blender" src="../img/tuto_content_authoring_vehicles/lights_blender.png" /></p>
<h3 id="uv-map">UV map</h3>
<p>The different types of lights (headlights, blinkers, brake lights, etc.) are distinguished using a texture. You need to create a UV map in your 3D modelling application and position the lights to match up with the relevant region of the texture. </p>
<p><img alt="lights_uv" src="../img/tuto_content_authoring_vehicles/lights_uv_map.png" /></p>
<h3 id="importing">Importing</h3>
<p>Import the light mesh into the Unreal Editor- After importing the light mesh:</p>
<ul>
<li>Drag the mesh item(s) into the <strong><em>Mesh (VehicleMesh) (Inherited)</em></strong> hierarchy in the <strong><em>Components</em></strong> panel.</li>
<li>Select the extra meshes in the hierarchy and search for <code>Collision</code> in the <strong><em>Details</em></strong> panel.</li>
<li>Set <strong><em>Collision Presets</em></strong> to <code>NoCollision</code>.</li>
<li>Select any lights meshes in the hierarchy. Search for <code>Tag</code> in the <strong><em>Details</em></strong> panel and add the tag <code>emissive</code>.</li>
</ul>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../tuto_content_authoring_maps/" class="btn btn-neutral float-left" title="内容创作 - 地图"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../foundations/" class="btn btn-neutral float-right" title="基础">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../tuto_content_authoring_maps/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../foundations/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../extra.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
