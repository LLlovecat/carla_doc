<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Adv procedural building tool - CARLA 模拟器 中文文档</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../extra.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Adv procedural building tool";
        var mkdocs_page_input_path = "adv_procedural_building_tool.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> CARLA 模拟器 中文文档
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">主页</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">入门</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../start_introduction/">介绍</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../start_quickstart/">快速启动包安装</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">构建CARLA</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../build_linux/">Linux build</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../build_windows/">Windows build</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../build_update/">Update CARLA</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../build_system/">Build system</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../build_docker/">CARLA in Docker</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../build_faq/">F.A.Q.</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">第一步</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../core_concepts/">核心概念</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../core_world/">第一、 世界和客户端</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../core_actors/">第二、 角色和蓝图</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../core_map/">第三、地图和导航 </a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../core_sensors/">第四、 传感器和数据</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">高级概念</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_opendrive/">OpenDRIVE 独立模式</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_ptv/">PTV-Vissim 联合仿真</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_recorder/">Recorder</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_rendering_options/">渲染选项</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_rss/">RSS</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_synchrony_timestep/">同步和时间步长</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_benchmarking/">基准性能</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_agents/">CARLA 代理</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">交通模拟</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../ts_traffic_simulation_overview/">交通模拟概述</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_traffic_manager/">Traffic Manager</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../adv_sumo/">SUMO 联合仿真</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_scenic/">Scenic</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">参考</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../python_api/">Python API 参考</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../bp_library/">Blueprint Library</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ref_cpp/">C++ 参考</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ref_recorder_binary_file_format/">Recorder 二进制文件格式</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ref_sensors/">Sensors reference</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">插件</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../plugins_carlaviz/">carlaviz — web 可视化器</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">ROS 桥接器</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../ros_documentation/">ROS 桥文档</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">自定义地图</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_custom_map_overview/">CARLA 中自定义地图的概述</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_generate_map/">在 RoadRunner 中创建地图</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_add_map_package/">在CARLA包导入地图</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_add_map_source/">在 CARLA 源构建中导入地图</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_add_map_alternative/">导入地图的替代方法</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_manual_map_package/">手动准备地图包</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_custom_layers/">自定义地图：分层地图: Layered maps</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_custom_add_tl/">自定义地图：红绿灯和标志</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_custom_road_painter/">自定义地图：Road painter</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_custom_buildings/">自定义地图：程序建筑</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_custom_weather_landscape/">自定义地图：天气和景观</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_M_generate_pedestrian_navigation/">生成行人导航</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">大型地图</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../large_map_overview/">大型地图概述</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../large_map_roadrunner/">在RoadRunner中创建大地图</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../large_map_import/">导入/打包大地图</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">教程（通用）</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_add_friction_triggers/">添加摩擦触发器</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_control_vehicle_physics/">控制车辆物理模型</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_control_walker_skeletons/">控制行人骨骼</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_openstreetmap/">使用OpenStreetMap生成地图</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_retrieve_data/">检索模拟数据</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_carsim_integration/">CarSim 集成</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_rllib_integration/">RLlib 集成</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_G_chrono/">Chrono 集成</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../build_docker_unreal/">在 Docker 中构建虚幻引擎UE和 CARLA</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">教程（资产）</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_A_add_vehicle/">添加新车辆</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_A_add_props/">添加新道具</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_A_create_standalone/">创建独立包</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_A_material_customization/">材料定制</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">教程（开发人员）</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_D_contribute_assets/">如何升级内容</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_D_create_sensor/">创建一个传感器</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_D_create_semantic_tags/">创建语义标签</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_D_customize_vehicle_suspension/">自定义车辆悬架</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_D_generate_colliders/">生成详细碰撞</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tuto_D_make_release/">发布版本</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">CARLA 生态系统</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../ecosys_ansys/">Ansys 实时雷达模型</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">贡献</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../cont_contribution_guidelines/">贡献指南</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cont_code_of_conduct/">行为准则</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cont_coding_standard/">编码标准</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cont_doc_standard/">文档标准</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">CARLA 模拟器 中文文档</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">Adv procedural building tool</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <strong>Procedural Building Tool</strong> is currently an <strong>experimental feature</strong> and is not considered <em>production ready</em> at this stage. Hence it should only be used for experimental research projects.</p>
</div>
<h1 id="procedural-building-tool">Procedural Building Tool</h1>
<p>The <strong>Procedural Building Tool</strong> facilitates the generation of virtual 3D buildings for which the dimensions and decoration styles can be modulated to create a near infinite array of variations through a simple interface. The footprint dimensions and height in stories can be chosen through the interface. Then users can select a variety of styles for the building lobby, the body and the top floor or penthouse. A variety of facia element styles can be chosen for features such as corners windows and balconies from the CARLA asset library. </p>
<ul>
<li><a href="#opening-the-procedural-building-tool"><strong>Opening the tool</strong></a></li>
<li><a href="#base-parameters"><strong>Base parameters</strong></a></li>
<li><a href="#mesh-parameters"><strong>Mesh parameters</strong></a></li>
<li><a href="#mesh-elements"><strong>Mesh elements</strong></a><ul>
<li><a href="#sockets">Sockets</a></li>
</ul>
</li>
<li><a href="#facade-materials"><strong>Facade materials</strong></a></li>
<li><a href="#cooking"><strong>Cooking</strong></a></li>
</ul>
<h2 id="opening-the-procedural-building-tool">Opening the Procedural Building Tool</h2>
<p>Firstly, you need to add a procedural building actor to the scene. Navigate to <code>Content&gt;Carla&gt;Blueprints&gt;LevelDesign</code> and drag the <em>BP_ProceduralBuilding</em> blueprint into your map. Move the asset to the position where you wish to visualize the building. Choose a place where you have space so you can see the result clearly. Then to open the tool, launch the Procedural Building tool by right clicking on the <em>WD_ProceduralBuilding</em> widget and selecting <em>Run editor utility widget</em> from the context menu. This will open the tool's interface. </p>
<p><img alt="open_pb_tool" src="../img/open_pb_tool.png" /></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You must complete this step before opening the tool, an instance of the <em>BP_ProceduralBuilding</em> blueprint must exist in the map before the tool can function. You must also ensure that the <em>BP_ProceduralBuilding</em> entity is selected in the <em>World outliner</em> before proceeding.</p>
</div>
<h2 id="base-parameters">Base parameters</h2>
<p><img alt="base_parameters" src="../img/pb_base_parameters.png" /></p>
<p>In the base parameters section you select the fundamental properties of your building, such as the footprint and the height in floors.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Until you have selected mesh pieces in the <a href="#mesh-parameters">mesh parameters</a> section, you will not see any changes in the Unreal Engine viewport when you adjust the base parameters</p>
</div>
<p>The available parameters are as follows:</p>
<ul>
<li><strong>Seed</strong>: sets the random seed for the procedural generation, this enables variations on the building with the same settings.</li>
<li><strong>Num floors</strong>: sets the number of stories or floors the building will have, and henceforth defines the height of the building.</li>
<li><strong>Length X/Y</strong>: defines the size of the footprint of the building in the X and Y dimensions. These are unitless, the number denotes the number repeating sections, each section is a column of windows.</li>
<li><strong>Create automatically</strong>: if this option is selected, the building will automatically update in the viewport so you can see the effect of your adjustments.</li>
<li><strong>Corners</strong>: allows corner pieces to be added to the building, you can choose these pieces in the Mesh Parameters section.</li>
<li><strong>Walls</strong>: replace the middle pieces of the left/right/front/back of the building with alternate pieces that can be selected using the <a href="#mesh-parameters">Mesh parameters</a> menu.</li>
<li><strong>Doors</strong>: array allowing the placement of a door in the lobby level. The door is placed at the chosen index position.</li>
</ul>
<h2 id="mesh-parameters">Mesh parameters</h2>
<p><img alt="mesh_parameters" src="../img/pb_mesh_parameters.png" /></p>
<p>In the Mesh Parameters tab in the interface, we choose the mesh pieces that will be used to clad the exterior of the building. There are 5 categories of mesh pieces for different parts of the building:</p>
<ul>
<li><strong>Lobby</strong>: mesh pieces to decorate the lobby of the building.</li>
<li><strong>Midsection</strong>: mesh pieces to decorate the midsection of the building, every floor between the lobby and the top floor.</li>
<li><strong>Penthouse</strong>: mesh pieces to decorate the penthouse level.</li>
<li><strong>Doors</strong>: mesh pieces to add doors to the lobby</li>
<li><strong>Walls</strong>: mesh pieces to decorate the walls of the building</li>
</ul>
<p>In each category you will find numerous options for mesh pieces. Click on one or more such that they turn red, these will be added to the respective section of your building. If you choose more than one, the tool will randomly alternate between the choices. As you select the mesh pieces for each section of your building, if you have <em>Create automatically</em> selected in the base parameters section, you will see the building taking shape in the editor viewport.</p>
<p><img alt="building_parts" src="../img/pb_building_parts.png" /></p>
<h2 id="mesh-elements">Mesh elements</h2>
<p><img alt="mesh_elements" src="../img/pb_mesh_elements.png" /></p>
<p>In this section you can select the more detailed elements of the building such as windows, columns, plant pots, air conditioning units and antennas. Each type of decoration has slightly different properties.</p>
<p>There are numerous types of decoration for details of the building:</p>
<ul>
<li>
<p><strong>Vertical/Horizontal window meshes</strong>: these mesh pieces define the style of the window frames in the building. Vertical window meshes will occupy the window spaces that are taller than their width, while horizontal window meshes will occupy the window spaces that are wider than their height. If you select multiple options, they will alternate. </p>
</li>
<li>
<p><strong>Column meshes</strong>: these simulate brickwork column details that span the height of the building</p>
</li>
<li>
<p><strong>Top/Bottom window details</strong>: these meshes decorate the top of the windows with lintels and sunshades and the bottom of the windows with window sills and plant boxes.</p>
</li>
<li>
<p><strong>Window columns</strong>: brickwork columns that separate windows</p>
</li>
<li>
<p><strong>Curtain meshes</strong>: curtains and blinds to go inside the windows</p>
</li>
<li>
<p><strong>Pot meshes</strong>: plant pots that are added to window sills and plant boxes at specified socket points</p>
</li>
<li>
<p><strong>Air conditioner meshes</strong>: air conditioning units that are added to the windows at specified socket points</p>
</li>
<li>
<p><strong>Pipe meshes</strong>: pipes that descend the building vertically mimicking drainage pipes for the roof</p>
</li>
<li>
<p><strong>Wire meshes</strong>: wires that descend the building vertically mimicking TV aerial extensions and lightning grounding wires</p>
</li>
<li>
<p><strong>Antenna meshes</strong>: TV antennas that protrude from the windows</p>
</li>
</ul>
<p><img alt="mesh_variations" src="../img/pb_detail_variations.webp" /></p>
<p>The parameters work as follows:</p>
<p><strong>Common parameters</strong>:</p>
<ul>
<li><strong>Percentage</strong>: controls the amount pieces that will be placed on the building, 100% means all available spaces will be occupied</li>
<li><strong>Offset</strong>: spacial offset of the piece from the body of the building</li>
</ul>
<p><strong>Blinds and curtains</strong>:</p>
<ul>
<li><strong>Min/Max size</strong>: selects the min/max length of the blinds or curtains with random variation between the values. 1.0 is fully shut, 0.0 is fully open.</li>
</ul>
<p><strong>Pipes and wires</strong>:</p>
<ul>
<li><strong>Index</strong>: defines the face of the building where the pipe will be placed</li>
<li><strong>Offset side/front</strong>: adds a spatial offset to the piece from the center of the face of the building</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You may find in some cases that when you choose detail mesh pieces such as plant pots, antennas and air conditioning units, you don't see any change in the building. This is most likely because the pieces you are using don't have the appropriate sockets needed to add the pieces you chose. Refer to the <a href="#sockets">sockets section</a> to learn how to use sockets</p>
</div>
<h3 id="sockets">Sockets</h3>
<p><img alt="socket_details" src="../img/pb_detail_section.png" /></p>
<p>Sockets are anchor points which define where to place detail meshes on another mesh piece. To add sockets to the mesh pieces in the procedural building, with the procedural building selected, go to the <em>details panel</em>, normally on the right hand side of the UE editor interface. In there, you will find the <em>Meshes</em> and <em>Detail meshes</em> panels. Open the relevant section to open the mesh piece where you wish to place the socket.</p>
<p><img alt="mesh_details" src="../img/pb_mesh_details.png" /></p>
<p>Find the mesh on which you want to place a socket and double click the icon to open it in the editor. Click <em>create socket</em> to add a socket and name it using the following convention:</p>
<ul>
<li>Air conditioning unit: aa_*</li>
<li>Antennas: ant_*</li>
<li>Plant pots: pot_*</li>
</ul>
<p>Replace the asterisk with an index, depending upon how many sockets you have, i.e. aa_0, aa_2, aa_3...</p>
<p><img alt="socket_details" src="../img/pb_add_socket.png" /></p>
<p>When you click <em>Create socket</em> the socket will be instantiated in the editor with a 3D handle. Drag the socket to the desired position on the mesh, this is where your detail piece will appear attached to the unit. </p>
<h2 id="facade-materials">Facade materials</h2>
<p><img alt="facade_materials" src="../img/pb_facade_materials.png" /></p>
<p>In the facade materials tab, you can browse and preview the material that you want to decorate the walls of your building.</p>
<p><img alt="facade_changes" src="../img/pb_facade_changes.webp" /></p>
<h2 id="cooking">Cooking</h2>
<p>In the cooking tab, you initiate the combination of all the mesh pieces and materials you've selected into a single static mesh with associated materials and textures. An LOD texture of the building will also be created for the LOD. Specify a folder name in the interface where the assets for your new building will be saved.</p>
<p>Once you have cooked your building, you will then be able to place instances of the building in the map just like any other CARLA assets.</p>
              
            </div>
          </div><footer>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../extra.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
